{"id":"cacfa0a6aed6de178313fa7c72ebd111","product_family":"wisduo","product_id":"rak3172-sip","category":"Concept","title":"RAK3172-SiP Hardware Considerations and Optimization Guidelines","content":"## Overview\n\nThe RAK3172-SiP is a specialized WisDuo LPWAN module due to its SiP package. This document lists various hardware considerations and details to optimize module operation. It provides general information and guidelines for fine-tuning the module based on your application.\n\nThis document discusses the following:\n\n- [Schematic Notes](#schematic-notes)\n- [Power Supply Management](#power-supply-management)\n- [Layout Guideline](#layout-guideline)\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\application-note.md","token_count":0}
{"id":"77f62f9c7a411c6f2dc520fd62343cfa","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP Schematic Notes and Design Considerations","content":"## Schematic Notes\n\n### RF Harmonic Compression\n\nPlace the harmonic suppression circuit close to the module's RF output. This might be necessary depending on your EMI test results. Default values are L102Â =Â 8.2Â nHÂ MurataÂ LQW15AN, C125Â =Â 3.3Â pF, and C126Â =Â 3.3Â pF.\n\n> **Image:** Harmonic Compression Circuit\n\n> **Image:** Harmonic Compression Circuit\n\n### RF Switch Control Table\n\nPA0 and PA1 are internally connected and control the RF path.\n\n| **VC1(PA0)** | **VC2(PA1)** | **RF_TX-RF_ANT** | **RF_RX-RF_ANT**  |\n| ------------ | ------------ | ---------------- | ----------------- |\n| High         | Low          | Off              | On                |\n| Low          | High         | On               | Off               |\n\n> **Image:** RF Switch\n\n### Power Considerations\n\nAn independent LDO Buck or Boost converter for Vin regulated to VDD (3.3Â V) is recommended for RAK3172-SiP. Place the LDO Buck or Boost Converter as close as possible to the RAK3172-SiP power-related pins.\n\n> **Image:** Power pins\n\n> **Image:** Bypass Capacitors\n\n### Battery Protection\n\nThis is a safety feature you can add to the module. This will not affect the core functionality of the SiP module.\n\n> **Image:** Battery Protection Circuit\n\n### Inductor Selection\n\nThe L1 (15Â Î¼H) consideration and recommendation:\n- DCR (max) = 2Â ohms\n- Idc (min) = 100Â mA\n- Freq (min) = 20Â MHz\n\n> **Image:** Inductor Selection\n\n| Reference       | Manufacturer | Value (uH) | Idc max (mA) | Freq (Mhz) | DCR (ohm) | Package (mm)       |\n| --------------- | ------------ | ---------- | ------------ | ---------- | --------- | ------------------ |\n| LPS3010-153     | Coilcraft    | 15         | 370          | 43         | 0.95      | 2.95 x 2.95 x 0.9  |\n| MLZ2012N150L    | TDK          | 15         | 90           | 40         | 0.47      | 2 x 1.25 x 1.25    |\n| MLZ2012M150W    | TDK          | 15         | 120          | 40         | 0.95      | 2 x 1.25 x 1.25    |\n| VLS2010ET-150M  | TDK          | 15         | 440          | 40         | 1.476     | 2 x 2 x 1          |\n| VLS2012ET-150M  | TDK          | 15         | 440          | 40         | 1.062     | 2 x 2 x 1.2        |\n\n### ST-LINK SWD Port\nConnect these three pins, SWDIO, SWCLK, and NRST, with the ST-LINK debugger.\n\n> **Image:** ST-Link Connection\n\n### NRST\nThe system reset is active low. Ensure to place R24/C16 as close as possible to the RAK3172-SIP module.\n\n> **Image:** NRST pin\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\application-note.md","token_count":0}
{"id":"6b6f57808287d99fd72c61dec2e23d92","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP Power Supply Management and Configurations","content":"## Power Supply Management\n\nThe RAK3172-SiP has two embedded regulators: one LDO and one DC/DC (SMPS). The SMPS can be optionally software-switched on to improve power efficiency.  Because the LDO and SMPS operate in parallel, switching on the SMPS is transparent to the user and improves power efficiency. This section discusses internal and external details of the RAK3172-SiP's power supply.\n\n### Power Supply Voltages\n\nThe devices require a VDD operating voltage supply between 1.8Â V and 3.6Â V. Several independent supplies (VDDSMPS, VFBSMPS, VDDA, VDDRF) may be provided for specific peripherals.\n\n- **VDD = 1.8Â V to 3.6Â V**\n\nVDD is the external power supply for the I/Os, the system's analog blocks such as reset, power management, internal clocks, and low-power regulators.  It is provided externally through VDD pins.\n\n- **VDDSMPS = 1.8Â V to 3.6Â V**\n\nVDDSMPS is the external power supply for the SMPS step-down converter. It is provided externally through the VDDSMPS supply pin and must be connected to the same supply as VDD.\n\n- **VFBSMPS = 1.45Â V to 1.62Â V (1.55Â V typical)**\n\nVFBSMPS is the external power supply for the main system regulator. It is provided externally via the VFBSMPS pin and supplied through an SMPS step-down converter.\n\n- **VDDA = 0Â V to 3.6Â V**\n\nVDDA is the external analog power supply for A/D converters, D/A converters, voltage reference buffers, and comparators. The VDDA voltage level is independent of the VDD voltage (refer to the power-up and power-down sequence section) and should preferably be connected to VDD when these peripherals are not in use.\n\n*DAC minimum voltage is 1.71Â V without buffer and 1.8Â V with buffer. COMP and ADC minimum voltages are 1.62Â V. VREFBUF minimum voltage is 2.4Â V.*\n\n- **VDDRF = 1.8Â Vto 3.6Â V**\n\nVDDRF is an external power supply for the radio. It is provided externally via the VDDRF pin and must be connected to the same supply as VDD.\n\n- **VBAT = 1.55Â Vto 3.6Â V**\n\nVBAT is the power supply for the RTC, TAMP, an external clock 32Â kHz oscillator, and backup registers (through a power switch) when VDD is not present.\n\n- **VREF-, VREF+**\n\nVREF+ is the input reference voltage for ADC and DAC. It is also the output of the internal voltage reference buffer when enabled.\n   - When VDDA < 2Â V, VREF+ must be equal to VDDA.\n   - When VDDA â‰¥ 2Â V, VREF+ must be between 2Â V and VDDA.\n\nVREF+ can be grounded when ADC/DAC is not active. The internal voltage reference buffer supports the following output voltages, configured with VRS bit in the VREFBUF_CSR register:\n   - VREF+ around 2.048Â V: this requires VDDA â‰¥ 2.4Â V.\n   - VREF+ around 2.5Â V: this requires VDDA â‰¥ 2.8Â V.\n\n**Power Up and Down Sequence**\n\nDuring power up and power down, the following power sequence is required:\n1.  When VDD < 1Â Vother, power supplies (VDDA) must remain below VDD + 300Â mV.\nDuring power down, VDD can temporarily become lower than other supplies only if the energy provided to the device remains below 1Â mJ. This allows external decoupling capacitors to be discharged with different time constants during this transient phase.\n\n2.  When VDD > 1Â V, all other power supplies (VDDA) become independent.\nAn embedded linear voltage regulator is used to supply the internal digital power VCORE. VCORE powers the digital peripherals, SRAM1 and SRAM2. The flash memory is powered by VCORE and VDD. VCORE is split into two parts: a VDDO part and an interruptible part, VDDI.\n\n> **Image:** RAK3172-SiP Power Section\n\n**VDDPA**\n\nTo transmit high output power up to + 22Â dBm, VDDPA must be supplied directly from VDD on the VDDSMPS pin, as shown in **Figure 11**.\n\n> **Image:** VDDPA Supply\n\nThe output power range is programmable in 32 steps of 1Â dB. The power amplifier ramping timing is also programmable, allowing adaptation to meet radio regulation requirements. The table below gives the maximum transmitter output power versus the VDDPA supply level.\n\n| VDDPA Supply (V) | Transmit Output Power (dBm) |\n| ---------------- | --------------------------- |\n| 3.3              | +22                         |\n| 2.7              | +20                         |\n| 2.4              | +19                         |\n| 1.8              | +16                         |\n\n### Power Supply Configurations\n\nThere are two different supply configurations, as shown in **Figure 12**.\n\n1.  By the MCU using the SMPSEN setting in PWR control register 5 (PWR_CR5), which depends on the MCU system operating mode (Run, Stop, Standby, or Shutdown).\n2.  By the sub-GHz radio using SetRegulatorMode() command and the sub-GHz radio operating mode (Sleep, Calibrate, Standby, Standby with HSE32 or Active).\n\n> **Image:** LDO and SMPS configurations\n\n**Power Supply Related Details**\n- After any POR and NRST reset, the LDO mode is selected.  SMPS selection has priority over LDO selection.\n- While the sub-GHz radio is in Standby with HSE32 or in Active mode, the supply mode is not altered until the sub-GHz radio enters Standby or Sleep mode. The sub-GHz radio activity may add a delay in entering the MCU software-requested supply mode.\n- The LDO or SMPS supply mode can be checked with the SMPSRDY flag in power status register 2 (PWR_SR2).\n- When the radio is active, the supply mode is not changed until the activity is finished.\n- During Stop 1, Stop 2, and Standby modes, when the sub-GHz radio is not active, the LDO or SMPS step-down converter is switched off. When exiting low-power modes (except Shutdown), the SMPS step-down converter is set by hardware to the mode selected by the SMPSEN bit in power control register 5 (PWR_CR5). SMPSEN is retained in Stop and Standby modes.\n- Independently of the MCU software-selected supply operating mode, the sub-GHz radio allows supply mode selection while active (possible due to the sub-GHz radio's *SetRegulatorMode()* command).\n- The maximum load current delivered by the SMPS is selectable via the sub-GHz radio SUBGHZ_SMPSC2R register.\n- The inrush current of the LDO and SMPS step-down converter is controllable via the sub-GHz radio SUBGHZ_PCR register. This information is retained in all modes except sub-GHz radio deep sleep mode.\n- The SMPS requires a clock to function. If this clock stops, the device may be destroyed. To prevent this, clock detection is used to switch off the SMPS and enable the LDO in case of clock failure.  The SMPS clock detection is enabled by the sub-GHz radio SUBGHZ_SMPSC0R.CLKDE bit. By default, SMPS clock detection is disabled and must be enabled before enabling the SMPS.\n\n\n> **WARNING:** Before enabling the SMPS, the SMPS clock detection must be enabled in the Sub-GHz radio SUBGHZ_SMPSC0R.CLKDE.\n\n\n### Power Supply Supervisor\n\nThe module integrates a power-on/power-down reset, coupled with brownout reset (BOR) circuitry.\n\n- **BOR (Brownout Reset)**\n\nBOR0 level cannot be disabled. Other BOR levels can be enabled via user option. When enabled, BOR is active in all power modes except shutdown. Five BOR thresholds are selectable through option bytes.\n\nDuring power-on, BOR keeps the device under reset until the supply voltage VDD reaches the specified VBORx threshold: \n\n  Â Â Â  â€¢ When VDD drops below the selected threshold, a device reset is generated. \n\n  Â Â Â  â€¢ When VDD is above the VBORx upper limit, the device reset is released and the system can start.\n\n- **PVD (Programmable Voltage Detector)**\n\nThe module features an embedded programmable voltage detector (PVD) that monitors the VDD power supply and compares it with the VPVD threshold.  An interrupt is generated when VDD drops below the VPVD threshold or when VDD is higher than the VPVD threshold. The interrupt service routine can then generate a warning message or put the MCU into a safe state.\n\nThe PVD is enabled by software and can be configured to monitor the VDD supply level needed for sub-GHz radio operation. For this, the PVD must select its lowest threshold, and the PVD and wakeup must be enabled by the EWPVD bit in the PWR_CR3 register. Only a voltage drop below the PVD level generates a wakeup event.\n\n- **PVM (Peripheral Voltage Monitor)**\n\nThe module features an embedded PVM (peripheral voltage monitor) that compares the independent supply voltage VDDA with a fixed threshold to ensure that the peripheral is within its functional supply range.\n\n- **Radio End-Of-Life Monitor**\n\nA radio end-of-life monitor provides information on the VDD supply when VDD is too low to operate the sub-GHz radio. When reaching the EOL level, the software must safely stop all activity.\n\n### Linear Voltage Regulator\n\nTwo embedded linear voltage regulators supply all digital circuitry, except for the standby circuitry and the backup domain. The main regulator (MR) output voltage (VCORE) can be programmed by software to two different power ranges (range 1 and range 2) to optimize consumption depending on the system's maximum operating frequency.  The voltage regulators are always enabled after a reset. Depending on the application mode, the VCORE supply is provided by either the main regulator or the low-power regulator (LPR).\n\nWhen MR is used, a dynamic voltage scaling is proposed to optimize power as follows:\n  - Range 1: High-performance range\n      - The system clock frequency can be up to 48Â MHz.\n      - The Flash memory access time for read access is minimized.\n      - Write and erase operations are possible.\n\n  - Range 2: Low-power range\n      - The system clock frequency can be up to 16Â MHz.\n      - The flash memory access time for read access is increased as compared to range 1.\n      - Write and erase operations are possible.\n\n### VBAT\n\n- **VBAT Operation**\n\nThe VBAT pin powers the device's VBAT domain (RTC, LSE, and backup registers) from an external battery, an external supercapacitor, or VDD when neither an external battery nor an external supercapacitor is present.  Three anti-tamper detection pins are available in VBAT mode. VBAT operation activates automatically when VDD is absent.\n\nAn internal VBAT battery charging circuit is embedded and activates when VDD is present.\n\n\n> **TIP:** NOTE\nWhen the microcontroller is supplied only from VBAT, external interrupts, and RTC alarms/events do not exit it from VBAT operation.\n\n\n- **VBAT Battery Voltage Monitoring**\n\nThis embedded hardware feature allows the application to measure the VBAT battery voltage using the ADC's VIN[14] input channel.  Because VBAT may be higher than VDDA, and thus outside the ADC's input range, the VBAT pin is internally connected to a resistor divider. As a consequence, the converted digital value is one-third the VBAT voltage.\n\n### Low-Power Modes\n\nThe module supports several low-power modes to achieve the best compromise between low power consumption, short startup time, available peripherals, and available wake-up sources. By default, the microcontroller is in Run mode, range 1, after a system or power-on reset.  It is up to the user to select one of the low-power modes described below:\n\n- **Sleep Mode:**\n\nCPU clock off; all peripherals, including CPU core peripherals (such as NVIC, SysTick), can run and wake the CPU when an interrupt or event occurs.\n\n- **Low-Power Run Mode (LPRun):**\n\nWhen the system clock frequency is reduced below 2Â MHz, the code is executed from the SRAM or the Flash memory. The regulator is in low-power mode to minimize the operating current.\n\n- **Low-Power Sleep Mode (LPSleep):**\n\nEntered from the LPRun mode.\n\n- **Stop 0 and Stop 1 Modes:**\n\nThe contents of SRAM1, SRAM2, and all registers are retained. All clocks in the VCORE domain are stopped. The PLL, MSI, HSI16, and HSE32 are disabled.  LSI and LSE may remain active. The RTC may remain active (Stop mode with RTC, Stop mode without RTC). The sub-GHz radio may remain active independently of the CPU. Some peripherals with wake-up capability may enable the HSI16 RC during Stop mode to detect their wake-up conditions.\n\n- **Stop 1 Mode:**\n\nStop 1 offers the largest number of active peripherals and wake-up sources, a smaller wake-up time, but higher consumption compared with Stop 2. In Stop 0 mode, the main regulator remains on, resulting in the fastest wake-up time but much higher consumption. The active peripherals and wake-up sources are the same as in Stop 1 mode, which uses the low-power regulator. When exiting Stop 0 or Stop 1 mode, the system clock can be either MSI up to 48Â MHz or HSI16, depending on the software configuration.\n\n- **Stop 2 Mode:**\n\nIn Stop 2 mode, part of the VCORE domain is powered off. Only SRAM1, SRAM2, the CPU, and some peripherals retain their contents. All clocks in the VCORE domain are stopped. The PLL, MSI, HSI16, and HSE32 are disabled.\n\nLSI and LSE may remain active. The RTC may remain active (Stop 2 mode with RTC, Stop 2 mode without RTC). The sub-GHz radio may also remain active independently of the CPU. Some peripherals with wake-up capability may enable the HSI16 RC during Stop 2 mode to detect their wake-up condition.\nThe system clock, when exiting Stop 2 mode, may be either MSI (up to 48Â MHz) or HSI16, depending on the software configuration.\n\n- **Standby Mode:**\n\nThe VCORE domain is powered off. However, SRAM2 content can be preserved as follows:\n\nÂ Â Â â€¢ Standby mode with SRAM2 retention: Set the RRS bit in PWR control register 3 (PWR_CR3). SRAM2 is supplied by the low-power regulator.  Standby mode without SRAM2 retention: Clear the RRS bit in PWR_CR3. The main and low-power regulators are powered off. All VCORE domain clocks (PLL, MSI, HSI16, and HSE32) stop. LSI and LSE may remain active.\n\nÂ Â Â â€¢ The RTC may remain active (Standby mode with or without RTC). The sub-GHz radio and PVD may also remain active if enabled independently.  In Standby mode, the PVD uses its lowest level.  Upon exiting Standby mode, the system clock is MSI at 4 MHz.\n\n- **Shutdown Mode:**\n\nThe VCORE domain is powered off. All clocks in the VCORE domain are stopped. The PLL, MSI, HSI16, LSI, and HSE32 are disabled. The LSE can be kept running. The system clock when exiting shutdown mode is the MSI at 4Â MHz. In this mode, supply voltage monitoring is disabled, and product behavior is not guaranteed in case of a power voltage drop.\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\application-note.md","token_count":0}
{"id":"0a3fe4cbc75c7bf09a50a8231ac4882c","product_family":"wisduo","product_id":"rak3172-sip","category":"How-To","title":"Layout Guidelines for RAK3172-SIP Module","content":"## Layout Guideline\n\n- **Power Trace Management**\n    - Power traces should be directly connected to the regulator outputs, and then add 4.7Â ÂµF bypass capacitors close to the module on each power trace.\n    - Never let power traces cross each other or high-speed signal traces.\n\n- **Ground Management**\n    - Ensure (1) GND polygon regions used for the module are as complete as possible and (2) well-established GND via holes are present, to maintain good heat dissipation and RF performance.\n    - The reference ground planes of RF traces need additional via holes; we recommend a distance between each of less than 1/8Â Î».\n\n- **RF Trace Management**\n    - The CPWG model is recommended for RF trace calculation because of its superior EMC and RF capabilities.  Also, discuss with the PCB manufacturer how to evaluate and maintain the RF trace at 50Â Î©.\n    - The recommended layout for RF trace bends is to maintain the same width in the corner.\n\n    \n> **Image:** RF Trace\n\n    - The values of a and b will affect each other, it is best to control it not to be too wide from the width and gap of the output pad of the module\n\n    \n> **Image:** PCB RF Trace\n\n- **RF Matching Circuit**\n\n    - In Pi-matching circuits, it is advised to place them close to the LoRa antenna. For 50Â Î© matching antenna applications, connect a 100Â pF capacitor to the RF trace.\n\n    \n> **Image:** Pi-matching Circuit\n\n    - If you choose a metal coil antenna, the impedance will be lower ( < 50Â Î©) and it is inductive. Its R+jL is easier to fall on the upper left of the Smith Chart, so series inductance and parallel capacitance are the chosen matching method, but sometimes for bandwidth consideration, multi-level matching is also used.\n\n    \n> **Image:** Matching Circuit for Coil Antenna\n\n- **ESD Protection**\n    If used in a harsh ESD environment, the following example is a reference design for ESD protection. The recommended part is **Semtech - Rclamp2451z (1-Line, 24Â V)**.\n\n> **Image:** ESD Protection\n\n- **Shielding Cover**\n    - Shielding Cover design is recommended for EMI suppression.\n\n> **Image:** EMI Sheild\n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\application-note.md","token_count":0}
{"id":"9636547f51179aed5a350968c14fd085","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP AT Command Manual Overview","content":"## Overview\n\nThe RAK3172-SiP, based on the STM32WLE5 chip, simplifies LoRaWAN and LoRa point-to-point (P2P) communication.  To integrate LoRa technology into your projects, the RAK3172-SiP uses an easy-to-use UART communication interface for sending AT commands.  These AT commands set parameters for LoRa P2P and LoRaWAN communication. Any microcontroller with a UART interface can control the RAK3172-SiP.\n\nThe UART serial communication is exposed on the UART2 (also identified as **LPUART1 port**), through **Pin 29 (TX2)** and **Pin 30 (RX2)**. The default parameters of the UART2 communication are **115200 / 8-N-1**. Firmware upgrades are also possible through this port. To familiarize yourselft with the pin distribution of this module and find a schematic circuit of a reference application, refer to the [RAK3172-SiP Datasheet](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/datasheet/).\n\n\n> **WARNING:** The RAK3172-SiP does not have pre-flashed LoRaWAN credentials. In this case, you have to define and setup your own unique credentials for the SiP's.\n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\at-command-manual.md","token_count":0}
{"id":"05e77eb9466ec2dfeafc9f4d6ff29a1c","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP RUI3 AT Command List","content":"## RUI3 AT Command List\n\nThe RAK3172-SiP default firmware is based on [RUI3 (RAKwireless Unified Interface V3)](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/overview/). You can access the AT command via UART2 by default.\n\nThe complete list of commands can be found in [RUI3 AT Commands Documentation.](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/at-command-manual/)\n\n\n> **TIP:** NOTE\nIn addition, aside on UART2, AT commands can also be interfaced via UART1 **Pin 17 (TX1)** and **Pin 18 (RX1)**. You can configure the settings of UART1 and UART2 interfaces via [RUI3 Serial Operating Modes](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/#rak-unified-interface-v3-rui3-serial-operating-modes).\n\n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\at-command-manual.md","token_count":150}
{"id":"015711ec8799a57c4de75a0c52b413fc","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP and RAK3172LP-SiP Overview and Features","content":"## Overview\n\n### Description\n\nRAK3172-SiP (and the RAK3172LP-SiP variant) are low-power, long-range transceivers based on the STM32WLE5JC SoC in a system-in-package form factor.  These two modules use different RF output paths to optimize current consumption depending on the application.  RAK3172-SiP uses RFO_HP, while RAK3172LP-SiP uses the RFO_LP of the STM32WL SoC transceiver.\n\nWisDuo SiP LoRa modules provide a small, easy-to-use, low-power solution for long-range wireless data applications. These modules comply with Classes A, B, and C of the LoRaWAN 1.0.3 specifications. They can easily connect to different LoRaWAN server platforms such as TheThingsNetwork (TTN), Helium, ChirpStack, and Actility. They also support LoRa point-to-point (P2P) communication mode, which facilitates the quick implementation of customized long-range LoRa networks.\n\nYou can configure the mode and operation of the RAK3172-SiP/RAK3172LP-SiP using AT commands via a UART interface or create custom firmware using the RUI3 API.  The RAK3172-SiP/RAK3172LP-SiP are very small and offer low-power features suitable for battery-powered applications.\n\n\n> **WARNING:** The RAK3172-SiP does not have pre-flashed LoRaWAN credentials and you have to define and setup your own unique credentials for the SiP's.\n\n\n### Features\n\n- Based on **STM32WLE5JC**\n- Two variants available\n    - RAK3172-SiP (uses RFO_HP)\n    - RAK3172LP-SiP (uses RFO_LP)\n- System-in-Package form factor\n- RUI3 API compatible\n- **LoRaWAN 1.0.3** specification compliant\n- **Supported bands**: IN865, EU868, AU915, US915, KR920, RU864, and AS923\n- LoRaWAN Activation by OTAA/ABP\n- LoRa Point-to-Point (P2P) communication\n- Custom firmware using Arduino via RUI3 API\n- Easy-to-use AT Command set via UART interface\n- Long-range - up to 15Â km with optimized antenna\n- ARM Cortex-M4 32-bit\n- 256Â kbytes flash memory with ECC\n- 64Â kbytes RAM\n- Ultra-low power consumption of 1.69Â Î¼A in sleep mode\n- **Supply voltage**: 2.0Â V ~ 3.6Â V\n- **Temperature range**: -40Â°Â C ~ 85Â°Â C\n- **Size**: 12Â mm x 12Â mm x 1.22Â mm\n- **Package**: LGA73 type\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\datasheet.md","token_count":0}
{"id":"46e287fd0c4c75290478e946fbde7d4a","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP Hardware and Software Specifications","content":"## Specifications\n\nThis section covers the hardware and software specifications for the RAK3172-SiP.  It also includes a block diagram and an updated firmware link for the RAK3172-SiP WisDuo Module.\n\n### Overview\n\n#### Block Diagram\n\n> **Image:** RAK3172-SiP system block diagram\n\n### Hardware\n\nThe hardware specification is categorized into six parts.  It discusses the interfacing, pinouts, and their corresponding functions and diagrams. It also covers the RF, electrical, mechanical, and environmental parameters, including tabular data of the functionalities and standard values of the RAK3172-SiP WisDuo LPWAN SiP module.\n\n\n> **TIP:** NOTE\n\nFor the reference application schematic of RAK3172-SiP with minimum components requirements, refer to the [RAK3272-SiP Breakout Board Datasheet.](https://docs.rakwireless.com/product-categories/wisduo/rak3272-sip-breakout-board/datasheet/#hardware)\n\n\n#### Interfaces\n\n| Module        | Interfaces                            |\n| :-----------: | :-----------------------------------: |\n| RAK3172-SiP   | UART2 (Default for AT Command), UART1 |\n| RAK3172LP-SiP | UART2 (Default for AT Command), UART1 |\n\n#### Pin Definition\n\nYou can check the pin definitions on the table and illustration, as shown in **Figure 2**.\n\n> **Image:** RAK3172-SiP top view pin diagram\n\n\n> **WARNING:** When using the `RF_OUT` pin for an antenna and not the IPEX connector variant, design considerations are necessary to ensure optimum RF performance.\n\n- The RF trace must be away from sources of interference (switching nodes of DC-DC supplies, high-current/high-voltage pulses from controllers of inductive loads like motors, signal generators, etc.).\n- The RF trace must have 50-ohm impedance.  Using impedance simulation software is advisable to achieve this.\n- If using an external antenna connector, position it close to the `RF_OUT` pin.\n- Ground plane optimization is critical for certain antenna types, such as monopoles.\n- The GND trace used for the RF return path must be directly connected to the GND plane and not treated as a thermal relief.\n- It is recommended to route the RF trace in a curve, rather than with sharp 90-degree angles.\n\nIn addition, with a commitment to making IoT easy, RAK offers a dedicated service for [Antenna RF Design](https://store.rakwireless.com/products/antenna-rf-design-service-including-pcb-design-tuning-matching-and-rf-test) which includes PCB design, tuning, matching, and RF testing.\n\n\n| **Pin No.** | **Name**     | **Type** | **Description**                                                    |\n| :---------: | :----------: | :------: | ------------------------------------------------------------------ |\n| 1           | PA13         | I        | Reserved - SWD debug pin (SWDIO)                                   |\n| 2           | PA14         | O        | Reserved - SWD debug pin (SWCLK)                                   |\n| 3           | VDD          |          | VDD                                                                |\n| 4           | VBAT         |          | VDD (For RTC)                                                      |\n| 5           | PC13         | I/O      | GPIO                                                               |\n| 6           | VREF+        |          | Input reference voltage for ADC                                    |\n| 7           | VDDA         |          | External power supply for the analog sections (ADC Converter)      |\n| 8           | PA15         | I/O      | GPIO or PIN_A4                                                     |\n| 9           | PB15         | I/O      | GPIO                                                               |\n| 10          | VFBSMPS      |          | DC-DC switching power feedback                                     |\n| 11          | VDDMPS       |          | DC-DC switching power input                                        |\n| 12          | GND          |          | Ground                                                             |\n| 13          | VLXSMPS      |          | DC-DC switching output                                             |\n| 14          | PB3          | I/O      | GPIO or PIN_A0                                                     |\n| 15          | PB4          | I/O      | GPIO or PIN_A1                                                     |\n| 16          | PB5          | I/O      | GPIO                                                               |\n| 17          | PB6/UART1_TX | I/O      | GPIO or UART1_TX                                                   |\n| 18          | PB7/UART1_RX | I/O      | GPIO or UART1_RX                                                   |\n| 19          | PB8          | I/O      | GPIO                                                               |\n| 20          | PB9          | I/O      | GPIO                                                               |\n| 21          | PC0          | I/O      | GPIO                                                               |\n| 22          | PC1          | I/O      | GPIO                                                               |\n| 23          | PC2          | I/O      | GPIO                                                               |\n| 24          | PC3          | I/O      | GPIO                                                               |\n| 25          | PC4          | I/O      | GPIO                                                               |\n| 26          | PC5          | I/O      | GPIO                                                               |\n| 27          | PC6          | I/O      | GPIO                                                               |\n| 28          | GND          |          | Ground                                                             |\n| 29          | PA2/UART2_TX | O        | Reserved - UART2/LPUART1 Interface (AT Commands and FW Update)     |\n| 30          | PA3/UART2_RX | I        | Reserved - UART2/LPUART1 Interface (AT Commands and FW Update)     |\n| 31          | PA4          | I/O      | GPIO or SPI1 (SPI1_CS)                                             |\n| 32          | PA5          | I/O      | GPIO or SPI1 (SPI1_CLK)                                            |\n| 33          | PA6          | I/O      | GPIO or SPI1 (SPI1_MISO)                                           |\n| 34          | PA7          | I/O      | GPIO or SPI1 (SPI1_MOSI)                                           |\n| 35          | GND          |          | Ground                                                             |\n| 36          | GND          |          | Ground                                                             |\n| 37          | RF_OUT       | O        | RF Output                                                          |\n| 38          | GND          |          | Ground                                                             |\n| 39          | GND          |          | Ground                                                             |\n| 40          | NC           |          | Not connected                                                      |\n| 41          | NC           |          | Not connected                                                      |\n| 42          | NC           |          | Not connected                                                      |\n| 43          | BOOT 0       | I        | Boot Mode Select pin (Activates STM32WL UART Bootloader when HIGH) |\n| 44          | NRST         | I        | MCU Reset (NRST)                                                   |\n| 45          | NC           |          | Not connected                                                      |\n| 46          | GND          |          | Ground                                                             |\n| 47          | GND          |          | Ground                                                             |\n| 48          | PB11         | I/O      | GPIO                                                               |\n| 49          | PB10         | I/O      | GPIO                                                               |\n| 50          | PA9          | I/O      | GPIO or I2C_SCL                                                    |\n| 51          | PA8          | I/O      | GPIO                                                               |\n| 52          | GND          |          | Ground                                                             |\n| 53          | VDDPA        |          | RF PA power input                                                  |\n| 54          | VDDRF        |          | RF Segment power input                                             |\n| 55          | VDD          |          | VDD                                                                |\n| 56          | GND          |          | Ground                                                             |\n| 57          | PB1          | I/O      | GPIO                                                               |\n| 58          | PB2          | I/O      | GPIO or PIN_A2                                                     |\n| 59          | PB12         | I/O      | GPIO                                                               |\n| 60          | PB13         | I/O      | GPIO                                                               |\n| 61          | PB14         | I/O      | GPIO                                                               |\n| 62          | PA10         | I/O      | GPIO or PIN_A3 or I2C_SDA                                          |\n| 63          | PA11         | I/O      | GPIO                                                               |\n| 64          | PA12         | I/O      | GPIO                                                               |\n| 65-73       | GND          |          | Ground                                                             |\n\n#### RF Characteristics\n\nThe RAK3172-SiP supports the frequency of operation from 863 to 930Â Mhz.\n\n##### Operating Frequencies\n\n| Region        | Frequency     |\n| :-----------: | :-----------: |\n| Europe        | EU868         |\n| North America | US915         |\n| Australia     | AU915         |\n| Korea         | KR920         |\n| Asia          | AS923-1/2/3/4 |\n| India         | IN865         |\n| Russia        | RU864         |\n\n#### Electrical Characteristics\n\n##### Absolute Maximum Ratings\n\n| Parameter    | Minimum     | Typical | Maximum | Unit      |\n| :----------: | :---------: | :-----: | :-----: | :-------: |\n| VDD and GPIO | -0.3Â V | -       | 3.9     | Volts (V) |\n\n##### Operating Voltage\n\n| Parameter                             | Minimum | Typical | Maximum | Unit      |\n| :-----------------------------------: | :-----: | :-----: | :-----: | :-------: |\n| VCC                                   | 1.8     | -       | 3.6     | Volts (V) |\n| VDDA (ADC or COMP used)               | 1.71    | -       | 3.6     | Volts (V) |\n| VDDA (VREFBUF used)                   | 2.4     | -       | 3.6     | Volts (V) |\n| VDDA (ADC, COMP, or VREFBUF not used) | 0       | -       | 3.6     | Volts (V) |\n| VBAT                                  | 1.55    | -       | 3.6     | Volts (V) |\n| VDDSMPS                               | 1.8     | -       | 3.6     | Volts (V) |\n| VDDRF                                 | 1.8     | -       | 3.6     | Volts (V) |\n| VDDPA                                 | 1.8     | -       | 3.6     | Volts (V) |\n| VREF+                                 | 2.0     | -       | VDDA    | Volts (V) |\n| VREF+ (VDDA < 2Â V)               | VDDA    | -       | VDDA    | Volts (V) |\n\n##### Operating Current\n\n###### RAK3172-SiP (uses RFO_HP RF output)\n\n| Parameter  | Condition   | Current Consumption (Typical) |\n| :--------: | :---------: | :---------------------------: |\n| TX mode    | 20Â dBm | 87Â mA                    |\n| RX mode    | -           | 6.14Â mA                  |\n| Sleep mode | -           | 1.69Â uA                  |\n\n###### RAK3172LP-SiP (uses RFO_LP RF output)\n\n| Parameter | Condition | Current Consumption (Typical) |\n| --- | --- | --- |\n| TX mode | 14 dBm | 39.1 mA |\n| TX mode | 12 dBm | 33 mA |\n| TX mode | 10 dBm | 28 mA |\n| TX mode | 8 dBm | 25 mA |\n| RX mode | - | 9.69 mA |\n| Sleep mode | - | 2.1 uA |\n\n#### Mechanical Characteristics\n\n##### Module Dimensions\n\n> **Image:** RAK3172-SiP mechanical dimension\n\n##### Layout Recommendation\n\n> **Image:** RAK3172-SiP layout\n\n#### Environmental Characteristics\n\n##### Operating Temperature\n\n| Feature               | Minimum | Typical | Maximum | Unit |\n| :-------------------: | :-----: | :-----: | :-----: | :--: |\n| Operating Temperature | -40     | 25      | 85      | Â°C   |\n\n##### Storage Temperature\n\n| Feature             | Minimum | Typical | Maximum | Unit |\n| :-----------------: | :-----: | :-----: | :-----: | :--: |\n| Storage Temperature | -40     | -       | 85      | Â°C   |\n\n##### Recommended Reflow Profile\n\n\n> **WARNING:** - On SMT reflow process, follow MSL3 (Moisture Sensitivity Level 3) guidance for PCBA assembly.\n- Before SMT reflow, it is recommended to bake at 125Â°Â C for 12Â hours first to reduce the risk of soldering issues and abnormalities.\n\n\n> **Image:** Reflow profile for RAK3172-SiP\n\nStandard conditions for reflow soldering:\n\n- Pre-heating Ramp (A) (Initial temperature: 150Â°Â C): **1~2.5Â°Â C/sec**\n- Soaking Time (T2) (110~190Â°Â C): **90~120Â sec**\n- Peak Temperature (G): **240~245Â°Â C**\n- Reflow Time (T3) (240-245Â°Â C): **50~70Â sec**\n- Ramp-up Rate (B): **1-3Â°Â C/sec**\n- Ramp-down Rate (C): **1~5Â°Â C/sec**\n\n### Software\n\nDownload the latest RAK3172-SiP WisDuo LPWAN SiP firmware provided below.\n\n- The **bin file** contains the application code only and you need the RAK DFU Tool to upload this file to RAK3172-SiP via UART.\n- The **hex file** contains both the bootloader and the application code. You need to [use STM32CubeProgrammer to upload](https://learn.rakwireless.com/hc/en-us/articles/26687606549911-How-To-Guide-STM32CubeProgrammer-for-RAK-Modules) this.\n\nRAK3172-SiP uses UART2 serial pins to upload the latest firmware.\n\n#### Firmware/OS\n\nDownload the latest RAK3172-SiP and RAK3172LP-SiP firmware provided below.\n\n| Model                | Version                   | Source                                                                                                                 |\n| :------------------: | :-----------------------: | :--------------------------------------------------------------------------------------------------------------------: |\n| RAK3172-SiP (.bin)   | RUI3 (App only)           | [Download](https://downloads.rakwireless.com/RUI/RUI3/Image/RAK3272-SiP_latest.bin)         |\n| RAK3172-SiP (.hex)   | RUI3 (Bootloader and App) | [Download](https://downloads.rakwireless.com/RUI/RUI3/Image/RAK3272-SiP_latest_final.hex)   |\n| RAK3172LP-SiP (.bin) | RUI3 (App only)           | [Download](https://downloads.rakwireless.com/RUI/RUI3/Image/RAK3272LP-SiP_latest.bin)       |\n| RAK3172LP-SiP (.hex) | RUI3 (Bootloader and App) | [Download](https://downloads.rakwireless.com/RUI/RUI3/Image/RAK3272LP-SiP_latest_final.hex) |\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\datasheet.md","token_count":0}
{"id":"258ff53bfc35adc1796ed2cc3078fd38","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SiP Models and Ordering Information","content":"## Models and Bundles\n\n### Ordering Information\n\n| P/N                 | Model       | Frequency                           | SKU    |\n| :-----------------: | :---------: | :---------------------------------: | :----: |\n| RAK3172-SIP-8-SM-NI | RAK3172-SiP | 8XX MHz for RU864/IN865/EU868       | 305041 |\n| RAK3172-SIP-9-SM-NI | RAK3172-SiP | 9XX MHz for US915/AU915/KR920/AS923 | 306039 |\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\datasheet.md","token_count":0}
{"id":"dd0fb5773bc600d928410d1a2baa18f1","product_family":"wisduo","product_id":"rak3172-sip","category":"Reference","title":"RAK3172-SIP Certification Documents","content":"## Certification\n\n### Certifications\n- **ANATEL:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_ANATEL_Certification.pdf\n- **CE:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_CE_Certification.pdf\n- **FCC:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_FCC_Certification.zip\n- **ISED:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_ISED_Certification.pdf\n- **JRL:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_JRL_Certfication.pdf\n- **KC:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_KC_Certification.pdf\n- **LORAWAN:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_Lora_Alliance_Certification.pdf\n- **RCM:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_RCM_Certification.pdf\n- **REACH:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_REACH_Report.pdf\n- **ROHS:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_RoHS_Report.pdf\n- **RSM:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_RSM_Certification.pdf\n- **UKCA:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_UKCA_Certification.pdf\n- **WPC:** https://downloads.rakwireless.com/LoRa/RAK3172/Certification/RAK3172_WPC_Certification.pdf\n\n\n> **TIP:** Note\nFor CE and FCC certifications we provide an AT command guide.    \nYou can find it in our [RUI3 documentation](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/certification-guide) or get it from our [Download Center](https://downloads.rakwireless.com/#RUI/RUI3/Certification%20Guide/).\n \n\n  \n","keywords":["certification","ANATEL","CE","FCC","ISED","JRL","KC","LoRaWAN","RCM","REACH","ROHS","RSM","UKCA","WPC"],"source_file":"wisduo\\rak3172-sip\\datasheet.md","token_count":0}
{"id":"c2e3f9edc311f88cda16ecced3d978cb","product_family":"wisduo","product_id":"rak3172-sip","category":"General","title":"RAK3172-SiP WisDuo LPWAN SiP Overview","content":"# RAK3172-SiP WisDuo LPWAN SiP\n\nThank you for choosing **RAK3172-SiP WisDuo LPWAN SiP** in your awesome IoT project! ðŸŽ‰ To help you get started, we have provided you with all the necessary documentation for your product.\n\n* [Quick Start Guide](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/quickstart/)\n* [AT Command Manual](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/at-command-manual/)\n* [Datasheet](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/datasheet/)\n* [Application Note](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/application-note/)\n* [Reference Design](https://docs.rakwireless.com/product-categories/wisduo/rak3272-sip-breakout-board/datasheet/#schematic-diagram)\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\overview.md","token_count":0}
{"id":"499dfc1f5459d973d9b815607bddb697","product_family":"wisduo","product_id":"rak3172-sip","category":"Concept","title":"RAK3172-SiP and RAK3172LP-SiP Product Description","content":"## Product Description\n\nThe RAK3172-SiP (and RAK3172LP-SiP variant) are low-power, long-range transceivers based on the STM32WLE5JC SoC in a system-in-package form factor.  These two modules use different RF output paths to optimize current consumption depending on the application. The RAK3172-SiP uses RFO_HP, while the RAK3172LP-SiP uses the RFO_LP of the STM32WL SoC transceiver.\n\nWisDuo SiP LoRa modules provide a small, easy-to-use, low-power solution for long-range wireless data applications. These modules comply with Classes A, B, and C of the LoRaWAN 1.0.3 specifications. They can easily connect to different LoRaWAN server platforms such as The Things Network (TTN), Helium, Chirpstack, and Actility. They also support LoRa point-to-point (P2P) communication mode, which facilitates the implementation of customized long-range LoRa networks.\n\nThe RAK3172-SiP/RAK3172LP-SiP can be configured using AT commands via a UART interface or custom firmware using the RUI3 API.  The RAK3172-SiP/RAK3172LP-SiP are very small and offer low-power features suitable for battery-powered applications.\n\n\n> **WARNING:** The RAK3172-SiP does not have pre-flashed LoRaWAN credentials and you have to define and setup your own unique credentials for the SiP's.\n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\overview.md","token_count":0}
{"id":"ba7ee4db237f95f3ba6581ebdaf606c8","product_family":"wisduo","product_id":"rak3172-sip","category":"Concept","title":"RAK3172-SiP Product Features Overview","content":"## Product Features\n\n- Based on **STM32WLE5JC**\n- Two variants available\n    - RAK3172-SiP (uses RFO_HP)\n    - RAK3172LP-SiP (uses RFO_LP)\n- System-in-Package form factor\n- RUI3 API compatible\n- **LoRaWAN 1.0.3** specification compliant\n- **Supported bands**: IN865, EU868, AU915, US915, KR920, RU864, and AS923\n- LoRaWAN Activation by OTAA/ABP\n- LoRa Point-to-Point (P2P) communication\n- Custom firmware using Arduino via RUI3 API\n- Easy-to-use AT Command set via UART interface\n- Long-range - up to 15Â km with optimized antenna\n- ARM Cortex-M4 32-bit\n- 256Â kbytes flash memory with ECC\n- 64Â kbytes RAM\n- Ultra-low power consumption of less than 2Â Î¼A in sleep mode\n- **Supply voltage**: 2.0Â V ~ 3.6Â V\n- **Temperature range**: -40Â°Â C ~ 85Â°Â C\n- **Size**: 12Â mm x 12Â mm x 1.22Â mm\n- **Package**: LGA73 type\n\n\n> **TIP:** Note\nFor CE and FCC certifications we provide an AT command guide.    \nYou can find it in our [RUI3 documentation](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/certification-guide) or get it from our [Download Center](https://downloads.rakwireless.com/#RUI/RUI3/Certification%20Guide/).\n \n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\overview.md","token_count":0}
{"id":"ad0dbcdaf5d2eff785de7dddad4d0f99","product_family":"wisduo","product_id":"rak3172-sip","category":"How-To","title":"RAK3172-SiP WisDuo LPWAN SiP Quick Start Guide","content":"# RAK3172-SiP WisDuo LPWAN SiP Quick Start Guide\n\n\n> **WARNING:** The RAK3172-SiP does not have pre-flashed LoRaWAN credentials and you have to define and setup your own unique credentials for the SiP's.\n\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\quickstart.md","token_count":30}
{"id":"8f4a958651022467e3fc5683f2630b42","product_family":"wisduo","product_id":"rak3172-sip","category":"How-To","title":"Prerequisites for RAK3172-SiP WisDuo LPWAN SiP Installation","content":"## Prerequisites\n\nBefore going through the steps in the installation guide of the RAK3172-SiP WisDuo LPWAN SiP, make sure to prepare the necessary items listed below:\n\n### Hardware\n\n- [RAK3172-SiP WisDuo LPWAN SiP](https://store.rakwireless.com/products/wisduo-module-rak3172-sip?utm_source=RAK3172SiP&utm_medium=Document&utm_campaign=BuyFromStore)\n- Adapter PCB board for the RAK3172-SiP to access UART2 pins\n- USB-Serial Converter\n- Computer\n\n### Software\n\n- Download and install the [Arduino IDE](https://www.arduino.cc/en/Main/Software).\n\n----\n\n> **WARNING:** _**If you are using Windows 10**_.\nDo _**NOT**_ install the Arduino IDE from the Microsoft App Store. Instead, install the original Arduino IDE from the Arduino official website. The Arduino app from the Microsoft App Store has problems using third-party Board Support Packages.\n\n\n----\n\n- Add [RAK3172 as a supported board in Arduino IDE](#rak3172-sip-rui3-board-support-package-in-arduino-ide) by updating Board Manager URLs in **Preferences** settings of Arduino IDE with this JSON URL `https://raw.githubusercontent.com/RAKWireless/RAKwireless-Arduino-BSP-Index/main/package_rakwireless_com_rui_index.json`. After that, add **RAKwireless RUI STM32 Boards** via Arduino board manager.\n- [RAK Serial Port Tool](https://downloads.rakwireless.com/LoRa/Tools/RAK_SERIAL_PORT_TOOL_V1.2.1.zip)\n\n#### List of Acronyms\n\n| Acronym | Definition                                       |\n| :-----: | :----------------------------------------------: |\n| DFU     | Device Firmware Upgrade                          |\n| JTAG    | Joint Test Action Group                          |\n| LoRa    | Long Range                                       |\n| OTAA    | Over-The-Air-Activation (OTAA)                   |\n| ABP     | Activation-By-Personalization (ABP)              |\n| TTN     | The Things Network                               |\n| DEVEUI  | Device EUI (Extended Unique Identification)      |\n| APPEUI  | Application EUI (Extended Unique Identification) |\n| APPKEY  | Application Key                                  |\n| DEVADDR | Device Address                                   |\n| NWKSKEY | Network Session Key                              |\n| APPSKEY | Application Session Key                          |\n| P2P     | Point-to-Point                                   |\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\quickstart.md","token_count":0}
{"id":"fdb42dbf18b447b58d7a2d831df17e62","product_family":"wisduo","product_id":"rak3172-sip","category":"How-To","title":"Configuring RAK3172-SiP as a Stand-Alone Device Using RUI3","content":"## Product Configuration\n\n### RAK3172-SiP as a Stand-Alone Device Using RUI3\n\n#### Hardware Setup\n\nThe RAK3172-SiP requires a few hardware connections before you can make it work. The bare minimum requirement is to have the power section properly configured, reset button, antenna, and USB connection.\n\n\n> **WARNING:** Firmware update is done via UART2 pins. If you connect the module to an external device that will be interfacing with UART2, take extra precautions in your board design to ensure you can still perform FW update to it. There should be a way in your board design that can disconnect the external device to RAK3172-SiP UART2 before connecting the module to the PC (via USB-UART converter) for the FW update process.\n\nAn alternative option to update firmware aside from UART2 is to use SWD pins (SWCLK & SWDIO). This method will require you to use external tools like ST-LINK or RAKDAP1.\n\n\n> **Image:** RAK3172-SiP minimum schematic\n\nEnsure that the [antenna](https://store.rakwireless.com/products/pcb-antenna-for-lora) is properly connected to Pin 37 to have a good LoRa signal. Also, note that you can damage the RF section of the chip if you power the module without an antenna connected to the J1 using an IPEX connector.\n\n> **Image:** IPEX PCB LoRa Antenna\n\nYou can also use an RP-SMA connector in J2 where you can connect the LoRa [antenna](https://store.rakwireless.com/products/lora-antenna?variant=39942879641798), as shown in **Figure 3**.\n\n> **Image:** RP-SMA LoRa Antenna\n\n\n> **TIP:** NOTE\nDetailed information about the RAK3172-SiP LoRa antenna can be found on the [IPEX PCB]([link](https://downloads.rakwireless.com/#LoRa/WisBlock/Accessories/)) and [RP-SMA](https://downloads.rakwireless.com/#Accessories/Antenna/SMA-Antenna/) antenna datasheet.\n\n\n\n> **WARNING:** When using the LoRa transceiver, make sure that an antenna is always connected. Using this transceiver without an antenna can damage the module.\n\n\n#### Software Setup\n\nThe default firmware of the RAK3172-SiP module is based on RUI3, which allows you to develop your custom firmware to connect sensors and other peripherals to it. To develop your custom firmware using Arduino IDE, first, you need to add **RAKwireless RUI STM32 Boards** in the Arduino board manager, which will be discussed in this guide. You can then use RUI3 APIs for your intended application and upload also the custom firmware via UART. The AT commands of the RAK3172-SiP module are still available even if you compile custom firmware via RUI3. You can send AT commands via UART2 connection.\n\n##### RAK3172-SiP RUI3 Board Support Package in Arduino IDE\n\nIf you don't have an Arduino IDE yet, you can download it on the [Arduino official website](https://www.arduino.cc/en/Main/Software) and follow the installation procedure in the [miscellaneous section](#miscellaneous) of this document.\n\n\n> **TIP:** NOTE\n**For Windows 10 and up users**:\nIf your Arduino IDE is installed from the Microsoft App Store, you need to reinstall your Arduino IDE by getting it from the Arduino official website. The Arduino app from the Microsoft App Store has problems using third-party Board Support Packages.\n\n\nOnce the Arduino IDE has been installed successfully, configure the IDE to add the RAK3172-SiP to its board selection by following these steps:\n\n1. Open Arduino IDE and go to **File** > **Preferences**.\n\n> **Image:** Arduino preferences\n\n2. To add the RAK3172-SiP to your Arduino Boards list, edit the **Additional Board Manager URLs**. Click the icon, as shown in **Figure 5**.\n\n> **Image:** Modifying Additional Board Manager URLs\n\n3. Copy the URL `https://raw.githubusercontent.com/RAKWireless/RAKwireless-Arduino-BSP-Index/main/package_rakwireless_com_rui_index.json` and paste it on the field, as shown in **Figure 6**. If there are other URLs already there, just add them on the next line. After adding the URL, click **OK**.\n\n> **Image:** Add additional board manager URLs\n\n4. Restart the Arduino IDE.\n5. Open the Boards Manager from the Tools Menu.\n\n> **Image:** Opening Arduino boards manager\n\n6. Write `RAK` in the search bar, as shown in **Figure 8**. This will show the available RAKwireless module boards that you can add to your Arduino Board list. Select and install the latest version of the  **RAKwireless RUI STM32 Boards**.\n\n> **Image:** Installing RAKwireless RUI STM32 boards\n\n7. Once the BSP is installed, select  **Tools** > **Boards Manager** > **RAKWireless RUI STM32 Modules** > **WisDuo RAK3272-SiP Board**.\n\n> **Image:** Selecting RAK3272-SiP Board for RAK3172-SiP Module\n\n##### Compile an Example with Arduino Serial\n\n1. After completing the steps on adding your RAK3172-SiP to the Arduino IDE, try to run a simple program to test your setup. You need to add a USB connection to the bare minimum schematic of the RAK3172-SiP module, as shown in **Figure 10**.\n\n> **Image:** RAK3172-SiP with USB to Serial Schematic\n\n2. Connect the RAK3172-SiP via UART and check RAK3172-SiP COM Port using Windows **Device Manager**. Double-click the reset button if the module is not detected.\n\n> **Image:** Device manager ports (COM & LPT)\n\n3. Choose RAK3172-SiP on board selection select via **Tools** > **Boards Manager** > **RAKWireless RUI STM32 Modules** > **WisDuo RAK3272-SiP Board**.\n\n> **Image:** Selecting RAK3272-SiP Board for RAK3172-SiP Module\n\n4. Open the **Tools** menu and select a COM port. **COM28** is currently used.\n\n> **Image:** Select COM port\n\n5. You can see the serial monitor icon and click it to connect the COM port.\n\n> **Image:** Open Arduino serial monitor\n\n6. If the connection is successful, you can send AT Commands to RAK3172-SiP. For example: To check the RUI version, type `AT+VER=?` on the text area, then click on the **Send** button, as shown in **Figure 15**.\n\n> **Image:** Send AT command\n\n> **Image:** Arduino serial monitor COM28\n\n7. Open **Arduino_Serial** example code.\n\n> **Image:** Arduino Serial example\n\n8. Click on the **Verify** icon to check if you have successfully compiled the example code.\n\n> **Image:** Verify the example code\n\n9. Click the **Upload** icon to send the compiled firmware to your RAK3172.\n\n> **Image:** Upload the example code\n\n10. If the upload is successful, you will see the **Device programmed** message.\n\n> **Image:** Device programmed successfully\n\n11. After the Device Programmed is completed, you will see the working Arduino_Serial example.\n\n##### RAK3172-SiP I/O Pins and Peripherals\n\nThis section discusses how to use and access RAK3172-SiP pins using RUI3 API. It shows basic code using digital I/O, analog input, UART, and I2C.\n\n<!--\n\n> **Image:** Available Peripherals and Digital I/O pins in RAK3172-SiP module\n\n-->\n\n###### How to Use Digital I/O\n\nYou can use any of the pins below as Digital Pin.\n\n| **Port Name** | **Alternative Pin Usage** |\n| :-----------: | :-----------------------: |\n| PA4           | SPI1_NSS                  |\n| PA5           | SPI1_CLK                  |\n| PA6           | SPI1_MISO                 |\n| PA7           | SPI1_MOSI                 |\n| PA8           |            -              |\n| PA9           | I2C_SCL                   |\n| PA10          | I2C_SDA / PIN_A4          |\n| PA15          | PIN_A3                    |\n| PB1           |            -              |\n| PB2           | PIN_A2                    |\n| PB3           | PIN_A0                    |\n| PB4           | PIN_A1                    |\n| PB5           |            -              |\n| PB6           | UART1_TX                  |\n| PB7           | UART1_RX                  |\n| PB8           |            -              |\n| PB9           |            -              |\n| PB10          |            -              |\n| PB11          |            -              |\n| PB12          |            -              |\n| PB13          |            -              |\n| PB14          |            -              |\n| PB15          |            -              |\n| PC0           |            -              |\n| PC1           |            -              |\n| PC2           |            -              |\n| PC3           |            -              |\n| PC4           |            -              |\n| PC5           |            -              |\n| PC6           |            -              |\n| PC13          |            -              |\n\nIn **Figure 21**, the available I/O pins are shown in purple.\n\n> **Image:** Available Digital I/O pins in RAK3172-SiP module\n\nThe pins listed below must not be used.\n\n| **Port Name** | **Pin Usage** | **Pin Number** |\n| :-----------: | :-----------: | :------------: |\n| PA2           | UART2_TX      |       29       |\n| PA3           | UART2_RX      |       30       |\n| PA13          | SWDIO         |       1        |\n| PA14          | SWCLK         |       2        |\n\n\n> **TIP:** NOTE\nThe GPIO pin name is the one to be used on the **digitalRead** and **digitalWrite** and NOT the pin numbers.\n\n\n- Use Arduino [digitalRead](https://www.arduino.cc/reference/en/language/functions/digital-io/digitalread/) to read the value from a specified Digital I/O pin, either HIGH or LOW.\n- Use Arduino [digitalWrite](https://www.arduino.cc/reference/en/language/functions/digital-io/digitalwrite/) to write a HIGH or a LOW value to a Digital I/O pin.\n\n**Example code**\n\n```c\nvoid setup()\n{\n  pinMode(PA15, OUTPUT); //Change the P0_04 to any digital pin you want. Also, you can set this to INPUT or OUTPUT\n}\n\nvoid loop()\n{\n  digitalWrite(PA15,HIGH); //Change the PA15 to any digital pin you want. Also, you can set this to HIGH or LOW state.\n  delay(1000); // delay for 1 second\n  digitalWrite(PA15,LOW); //Change the PA15 to any digital pin you want. Also, you can set this to HIGH or LOW state.\n  delay(1000); // delay for 1 second\n}\n```\n\n###### How to Use Analog Input\n\nYou can use any of the pins below as Analog Input.\n\n| **Port Name** | **ADC** | **Pin Number** |\n| :-----------: | :-----: | :------------: |\n| PB3           | PIN_A0  |       14       |\n| PB4           | PIN_A1  |       15       |\n| PB2           | PIN_A2  |       57       |\n| PA10          | PIN_A3  |       62       |\n| PA15          | PIN_A4  |       8        |\n\n- Use Arduino [analogRead](https://docs.arduino.cc/built-in-examples/basics/AnalogReadSerial/) to read the value from the specified Analog Input pin.\n\n> **Image:** Available Analog pins in RAK3172-SiP Module\n\n**Example code**\n\n```c\n#define analogPin PB3\n\nint val = 0;  // variable to store the value read\n\nvoid setup()\n{\n  Serial.begin(115200);\n}\n\nvoid loop()\n{\n  val = analogRead(analogPin);  // read the input pin\n  Serial.println(val);          // debug value\n  delay(100);\n}\n```\n\n###### How to Use Serial Interfaces\n\n**UART**\n\nThere are two UART peripherals available on the RAK3172-SiP module. There are also different [Serial Operating Modes](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/serial-operating-modes/) possible in RUI3, namely [Binary Mode](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/binary-command-manual/), [AT Mode](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/at-command-manual/), and [Custom Mode](https://docs.rakwireless.com/product-categories/software-apis-and-libraries/rui3/custom-mode/).\n\nUART Pin map table\n\n| **Port Name** | **Serial Port** | **Serial Instance Assignment** | **Default Mode** | **Pin Number** |\n| :-----------: | :-------------: | :----------------------------: | :--------------: | :------------: |\n| PB6           | UART1_RX        |            Serial1             | Custom Mode      |       17       |\n| PB7           | UART1_TX        |            Serial1             | Custom Mode      |       18       |\n| PA3           | UART2_RX        |             Serial             | AT Command       |       30       |\n| PA2           | UART2_TX        |             Serial             | AT Command       |       29       |\n\n> **Image:** Available UART pins in RAK3172-SiP Module\n\n**Example Code**\n\n```c\nvoid setup()\n{\n  Serial1.begin(115200); // use Serial1 for UART1 and Serial for UART2\n                         // you can designate separate baudrate for each.\n  Serial.begin(115200);\n}\n\nvoid loop()\n{\n  Serial1.println(\"RAK3172-SiP UART1 TEST!\");\n  Serial.println(\"RAK3172-SiP UART2 TEST!\");\n  delay(1000); // delay for 1 second\n}\n\n```\n\n**I2C**\n\nThere is one I2C peripheral available on RAK3172-SiP Module.\n\n| **Port Name** | **I2C Pin Name** | **Pin Number** |\n| :-----------: | :--------------: | :------------: |\n| PA9           | I2C_SCL          | 50             |\n| PA10          | I2C_SDA          | 62             |\n\nUse Arduino [Wire](https://www.arduino.cc/reference/en/language/functions/communication/wire/) library to communicate with I2C devices.\n\n> **Image:** Available I2C pins in RAK3172-SiP Module\n\n**Example Code**\n\nMake sure you have an I2C device connected to specified I2C pins to run the I2C scanner code below:\n\n```c\n#include <Wire.h>\n\nvoid setup()\n{\n  Wire.begin();\n\n  Serial.begin(115200);\n  while (!Serial);\n  Serial.println(\"\\nI2C Scanner\");\n}\n\nvoid loop()\n{\n  byte error, address;\n  int nDevices;\n\n  Serial.println(\"Scanning...\");\n\n  nDevices = 0;\n  for(address = 1; address < 127; address++ )\n  {\n    // The i2c_scanner uses the return value of\n    // the Write.endTransmission to see if\n    // a device did acknowledge to the address.\n    Wire.beginTransmission(address);\n    error = Wire.endTransmission();\n\n    if (error == 0)\n    {\n      Serial.print(\"I2C device found at address 0x\");\n      if (address<16)\n        Serial.print(\"0\");\n      Serial.print(address,HEX);\n      Serial.println(\"  !\");\n\n      nDevices++;\n    }\n    else if (error==4)\n    {\n      Serial.print(\"Unknown error at address 0x\");\n      if (address<16)\n        Serial.print(\"0\");\n      Serial.println(address,HEX);\n    }\n  }\n  if (nDevices == 0)\n    Serial.println(\"No I2C devices found\\n\");\n  else\n    Serial.println(\"done\\n\");\n\n  delay(5000);           // wait 5 seconds for next scan\n}\n```\n\nThe Arduino Serial Monitor shows the I2C device found.\n\n```c\n17:29:15.690 -> Scanning...\n17:29:15.738 -> I2C device found at address 0x28  !\n17:29:15.831 -> done\n17:29:15.831 ->\n17:29:20.686 -> Scanning...\n17:29:20.733 -> I2C device found at address 0x28  !\n17:29:20.814 -> done\n17:29:20.814 ->\n```\n**SPI**\n\nIf your RUI3 project uses SPI, then PA4 to PA7 pins are reserved for RUI3 SPI interface.\n\n| **Port Name** | **SPI Pin Name** | **Pin Number** |\n| :-----------: | :--------------: | :------------: |\n| PA4           | SPI1_CS          | 31             |\n| PA5           | SPI1_CLK         | 32             |\n| PA6           | SPI1_MISO        | 33             |\n| PA7           | SPI1_MOSI        | 34             |\n\n> **Image:** Available SPI pins in RAK3172-SiP Module\n\n\n> **TIP:** NOTE\nMore examples for the RAK3172-SiP can be found in the [RUI3-Best-Practices](https://github.com/RAKWireless/RUI3-Best-Practice) on Github.\n\n\n### RAK3172-SiP as a LoRa/LoRaWAN Modem via AT Command\n\n#### AT Command via UART2\n\nRAK3172-SiP module can be configured using AT commands via the UART2 interface. You need a USB to UART TTL adapter to connect the RAK3172-SiP to your computer's USB port and a serial terminal tool. You can use the [RAK Serial Port Tool](https://downloads.rakwireless.com/#LoRa/Tools) so you can easily send AT commands and view the replies from the console output. The RAK Serial Port Tool commands still use the RUI V2 AT commands by default. You can modify it to have RUI3 AT commands and then save it.\n\n\n> **WARNING:** Firmware update and AT command functionality are done via UART2 pins. If you will connect the module to an external host MCU that will send AT commands via UART2, take extra precautions in your board design to ensure you can still perform FW update to it. There should be a way in your board design that can disconnect the host MCU UART to connect to RAK3172 UART2 before connecting the module to the PC (via USB-UART converter) for the FW update process.\n\nAn alternative option to update firmware aside from UART2 is to use SWD pins (SWCLK & SWDIO). This method will require you to use external tools like ST-LINK or RAKDAP1.\n\n\n##### Connect to the RAK3172-SiP\n\n1. Connect the RAK3172-SiP to the serial port of a general-purpose computer (USB port) using a USB to UART TTL adapter like [RAKDAP1](https://store.rakwireless.com/collections/accessories/products/daplink-tool), as shown in **Figure 26**.\n\n\n> **TIP:** NOTE\nThere are other connections needed on the RAK3172-SiP aside from the VDD, GND, and UART2 pins. Check the minimal needed external connections in [RAK3272-SiP Breakout Board Schematic](https://docs.rakwireless.com/product-categories/wisduo/rak3272-sip-breakout-board/datasheet/#hardware).\n\n\n> **Image:** RAK3172-SiP UART2 connection\n\n2. Any serial communication tool can be used. But it is recommended to use the [RAK Serial Port Tool](https://downloads.rakwireless.com/#LoRa/Tools).\n3. Configure the serial communication tool by selecting the proper port detected by the computer and configure the link as follows:\n\n * Baud Rate: **115200Â baud**\n * Data Bits: **8Â bits**\n * Stop Bits: **1Â stopÂ bit**\n * Parity: **NONE**\n\n ##### RAK3172-SiP Configuration for LoRaWAN or LoRa P2P\n\nTo enable the RAK3172-SiP module as a LoRa P2P module or a LoRaWAN end-device, the module must be configured and parameters must be set by sending AT commands. You can configure the RAK3172-SiP in two ways:\n\n- [LoRaWAN End-Device](#configuring-rak3172-sip-as-lorawan-end-device) - RAK3172 as LoRaWAN IoT device.\n- [LoRa P2P](#lora-p2p-mode) - Point to point communication between two RAK3172-SiP.\n\n#### Configuring RAK3172-SiP as LoRaWAN End-Device\n\nTo enable the RAK3172-SiP as a LoRaWAN end-device, a device must be registered first in the LoRaWAN network server. This guide will cover both TTN and Chirpstack LoRaWAN network servers and the associated AT commands for the RAK3172-SiP.\n\n##### Connecting to The Things Network (TTN)\n\nIn this section, a quick tutorial guide will show how to connect the RAK3172-SiP to the TTN platform.\n\n\n> **TIP:** NOTE\nIn this guide, you need to have a working gateway that is connected to TTN or you have to be within the coverage of a TTN community network.\n\n\n> **Image:** RAK3172-SiP EVB in the context of the TTN\n\nAs shown in **Figure 27**, The Things Stack (TTN V3) is an open-source LoRaWAN Network Server suitable for global, geo-distributed public and private deployments, as well as for small local networks. The architecture follows the LoRaWAN Network Reference Model for standards compliance and interoperability. This project is actively maintained by [The Things Industries](https://www.thethingsindustries.com/).\n\nLoRaWAN is a protocol for low-power wide-area networks. It allows large-scale Internet of Things deployments where low-powered devices efficiently communicate with Internet-connected applications over long-range wireless connections.\n\nThe RAK3172-SiP WisDuo can be part of this ecosystem as a device, and the objective of this section is to demonstrate how simple it is to send data to The Things Stack using the LoRaWAN protocol. To achieve this, the RAK3172-SiP WisDuo must be located inside the coverage of a LoRaWAN gateway connected to The Things Stack server.\n\n##### Registration to TTN and Creating LoRaWAN Applications\n\n1. The first step is to go to [The Things Network](https://www.thethingsnetwork.org/) and sign up for an account shown in **Figure 28**. Then select a cluster as shown in **Figure 30**.\n\n> **Image:** Signing up an account in TTN\n\n> **Image:** Signing up an account in TTN\n\n> **Image:** Selecting Cluster in TTN\n\n> **Image:** Signing up through the Things ID\n\n> **Image:** Creation of an account through the Things ID\n\n> **Image:** Creation of an account through the Things ID\n\n You can use the same login credentials on the TTN V2 if you have one. If you have no account yet, you need to create one.\n\n2. Now that you are logged in to the platform, the next step is to create an application. Click **Create an application**.\n\n> **Image:** The Things Stack Platform\n\n> **Image:** Creating TTN application for your LoRaWAN devices\n\n3. To have an application registered, input first the specific details and necessary information about your application then click **Create application**.\n\n> **Image:** Details of the TTN application\n\n> **Image:** Details of the TTN application\n\n4. If you have no error on the previous step, you should now be on the application console page. The next step is to add end-devices to your TTN application.\n\nLoRaWAN specifications enforce that each end-device has to be personalized and activated. There are two options in registering devices depending on the activation mode selected. Activation can be done either via Over-The-Air-Activation (OTAA) or Activation-By-Personalization (ABP).\n\n##### TTN OTAA Device Registration\n\n1. Go to your application console to register a device. To start adding an OTAA end-device, click **+ Register end device**, as shown in **Figure 38**.\n\n> **Image:** Register end device\n\n2. To register the board, click the **Enter end device specifics manually**.\n\n> **Image:** Enter end device specifics manually\n\n3. Next step is to set up **Frequency plan**, compatible **LoRaWAN version**, and **Regional Parameters version** supported. Then provide the **JoinEUI** credentials by entering zeroes into it.\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n4. Then click **Show advanced activation, LoRaWAN class and cluster settings**. Configure the activation mode by selecting **Over the air activation (OTAA)** and Additional LoRaWAN class capabilities to **class A only**. Then click **Confirm**.\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n5. Once done, provide the DevEUI credentials of your device into the **DevEUI** portion. This will automatically generate the specific End\ndevice ID of your board. Then click **Generate** under **AppKey** under the Provisioning information section. Then click **Register end device**.\n\n\n> **TIP:** NOTE\n- The **AppEUI**, **DevEUI**, and **AppKey** are hidden in this section as these are unique from a specific device. The **DevEUI** credential is unique to every RAK3172-SiP device. Also, you should generate your own **AppEUI** and **AppKey** credentials for your specific device and application.\n- The **AppEUI** is the same as **JoinEUI**.\n\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Register end device\n\n6. You should now be able to see the device on the TTN console after you fully register your device, as shown in **Figure 49**.\n\n\n> **TIP:** NOTE\n- The **AppEUI**, **DevEUI**, and **AppKey** are the parameters that you will need to activate your LoRaWAN end-device via OTAA. The **AppKey** is hidden by default for security reasons, but you can easily show it by clicking the show button. You can also copy the parameters quickly using the copy button.\n- The three OTAA parameters on the TTN device console are MSB by default.\n- These parameters are always accessible on the device console page, as shown in **Figure 36**.\n\n\n> **Image:** OTAA device successfully registered to TTN\n\n##### OTAA Configuration for TTN\n\nThe RAK3172-SiP module can be configured using WisToolBox to do the OTAA configuration. **WisToolBox** is a software tool that supports **RAK3172-SiP** module. It automatically detects the RAK3172-SiP module once connected to the PC. Below are the options in WisToolBox that the OTAA configuration can be done.\n\n- [OTAA Configuration for TTN via WisToolBox UI](#otaa-configuration-for-ttn-via-wistoolbox-ui)\n- [OTAA Configuration for TTN via WisToolBox Console](#otaa-configuration-for-ttn-via-wistoolbox-console)\n\n##### OTAA Configuration for TTN via WisToolBox UI\n\nThe **RAK3172-SiP** should have the correct OTAA credentials to connect to TTN. This can be done using **WisToolBox UI**. Below are the steps on setting up your **RAK3172-SiP** using **WisToolBox**.\n\n1. Connect your **RAK3172-SiP** with your chosen WisBlock base board to the PC via USB cable and open the **WisToolBox** application.\n\n2. Click the **CONNECT DEVICE** button to launch the WisToolBox Dashboard.\n\n> **Image:** CONNECT DEVICE\n\n3. Then select your target port where your **RAK3172-SiP** is connected. Once recognized, click **CONNECT** as shown in **Figure 52**.\n\n> **Image:** Setting up your device\n\n> **Image:** Setting up your device\n\n4. Once done, **RAK3172-SiP** will appear in the dashboard then select it.\n\n> **Image:** Device seen from WisToolBox dashboard\n\n5. Then click **PARAMETERS** to do the configuration in your RAK3172.\n\n> **Image:** Setting up your device\n\n6. Click **Global settings** to set the network mode into **LoRaWAN** and join mode to **OTAA**. Make sure that the active region is using **EU868** for this configuration. If you wish to work on other regional bands, you can choose among active regions based on your location.\n\n- LoRa network mode: **LoRaWAN**\n- LoRaWAN join mode: **OTAA**\n- LoRaWAN region: **EU868**\n\n> **Image:** Global settings\n\n> **Image:** Global settings\n\n7. Then click **LoRaWAN keys, ID, EUI** to configure the **Application EUI (AppEUI)**, **Application key (AppKey)** and **Device EUI (DevEUI)**.\n\n> **Image:** LoRaWAN keys, ID, EUI\n\n> **Image:** Setting up your device\n\n8. Then go back to the console where your RAK3172-SiP End device is created previously. Then copy all the credentials from there. Those will be the ones to be used also in the WisToolBox dashboard. Once encoded into the dashboard, click **APPLY COMMAND** to update your device as shown in **Figure 66**.\n\n\n> **TIP:** NOTE\nThe **AppEUI**, **DevEUI**, and **AppKey** are hidden in this section as these are unique from a specific device.\n\n\n> **Image:** Your created an OTAA device from your console\n\n- **For Application EUI (AppEUI)**\n\n> **Image:** Copying the AppEUI credential from TTN to WisToolBox\n\n> **Image:** Copying the AppEUI credential from TTN to WisToolBox\n\n- **For Application key (AppKey)**\n\n> **Image:** Copying the AppKey credential from TTN to WisToolBox\n\n> **Image:** Copying the AppKey credential from TTN to WisToolBox\n\n- **For Device EUI (DevEUI)**\n\n> **Image:** Copying the DevEUI credential from TTN to WisToolBox\n\n> **Image:** Copying the DevEUI credential from TTN to WisToolBox\n\n- **WisToolBox Dashboard**\n\n> **Image:** Used credentials from your console in WisToolBox dashboard\n\n9. Once done, you will see the summary of commands that is applied to your device. Then click **CLOSE**.\n\n> **Image:** Summary of commands\n\n10. Now you will see it returns to the dashboard with updated credentials of your device.\n\n> **Image:** Successfully configured OTAA device via WisToolBox dashboard\n\n11. After your device's credentials update, it can now join the network. To do this, you need to go to **Data on LoRa network** under **PARAMETERS**. Then click the **JOIN NETWORK** under **LoRaWAN join settings**. After a few seconds, it will notify you that your OTAA device already joined the TTN server. You can also to your TTN console if your device has successfully joined the TTN.\n\n> **Image:** Joining mode of your OTAA device\n\n> **Image:** OTAA device successfully joined the TTN server\n\n> **Image:** OTAA device successfully joined the TTN server\n\n##### OTAA Configuration for TTN via WisToolBox Console\n\nHere's another way of OTAA configuration using **WisToolBox Console**. Below are the steps on setting up your **RAK3172-SiP** using **WisToolBox Console**.\n\n1. Connect your **RAK3172-SiP** with your chosen WisBlock base board to the PC via USB cable and open the **WisToolBox** application.\n\n2. Click the **CONNECT DEVICE** button to launch the WisToolBox Dashboard.\n\n> **Image:** CONNECT DEVICE\n\n3. Then select your target port where your **RAK3172-SiP** is connected. Once recognized, click **CONNECT** as shown in **Figure 74**.\n\n> **Image:** Setting up your device\n\n> **Image:** Setting up your device\n\n4. Once done, **RAK3172-SiP** will appear in the dashboard then select it.\n\n> **Image:** Device seen from WisToolBox dashboard\n\n5. Then click **ADVANCED**.\n\n> **Image:** Setting up your device\n\n6. Once done, click **OPEN CONSOLE** to do the configuration.\n\n> **Image:** OPEN CONSOLE\n\n> **Image:** Opening the Console terminal of WisToolBox\n\n> **Image:** Opening the Console terminal of WisToolBox\n\n7. To start the configuration, type **ATE** so you can echo the commands you input during your configuration. Then press **Enter**.\n\nIt is recommended to start by testing the console and verify that the current configuration is working by sending these two AT commands:\n\n```\nAT\n```\n\n```\nATE\n```\n\n`ATE` is useful for tracking the commands and troubleshooting.\n\nYou will receive `OK` when you input the two commands. After setting `ATE`, see all the commands you input together with the replies.\n\n\n> **TIP:** NOTE\nIf there is no `OK` or any reply, check if the device is powered correctly. If you are getting power from a USB port, ensure that you have a good USB cable.\n\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n8. Then configure the LoRaWAN join mode to **OTAA**. You can check what parameter you will input by typing **AT+NJM?** and then **Enter** into the console terminal. For **OTAA**, you should input **AT+NJM=1** and then press **Enter** as shown in **Figure 83**.\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n9. Once done, set up your LoRaWAN region to EU868. You can check what parameter you will input by typing **AT+BAND?** and then **Enter** into the console terminal. For **EU868**, you should input **AT+BAND=4** then press **Enter**. If you wish to work on other regional bands, you may check the list of band parameter options below.\n\nSet the frequency/region to EU868.\n\n```\nAT+BAND=4\n```\n\n\n> **TIP:** NOTE\n- Depending on the Regional Band you selected, you might need to configure the sub-band of your RAK3172 to match the gateway and LoRaWAN network server. This is especially important for Regional Bands like US915, AU915, and CN470.\n- To configure the masking of channels for the sub-bands, you can use the `AT+MASK` command that can be found on the [AT Command Manual](https://docs.rakwireless.com/product-categories/wisduo/rak3172-module/at-command-manual/#atmask).\n- To illustrate, you can use sub-band 2 by sending the command `AT+MASK=0002`.\n\n\n**List of band parameter options**\n\n| Code | Regional Band |\n| :--: | :-----------: |\n| 0    | EU433         |\n| 1    | CN470         |\n| 2    | RU864         |\n| 3    | IN865         |\n| 4    | EU868         |\n| 5    | US915         |\n| 6    | AU915         |\n| 7    | KR920         |\n| 8    | AS923-1       |\n| 9    | AS923-2       |\n| 10   | AS923-3       |\n| 11   | AS923-4       |\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n10. Then next to this will be updating the OTAA credentials of your device. First to this will be the **Application EUI (AppEUI)**. Go back to your console where your RAK3172 End device was created to copy the AppEUI credential then paste it to the WisToolBox Console then press **Enter**.\n\n> **Image:** You created an OTAA device from your TTN console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the AppEUI credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n11. Once done, do the same procedure to **Application key (AppKey)** and **Device EUI (DevEUI)**.\n\n- **For Application key (AppKey)**\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the AppKey credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n- **For Device EUI (DevEUI)**\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the DevEUI credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n12. Once done, click **Dashboard** to check the updated credentials of your OTAA device. Click **PARAMETERS** to open the **Global Settings** and **LoRaWAN keys, ID, EUI** and check whether these portions are updated.\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** PARAMETERS\n\n> **Image:** Global settings and LoRaWAN keys, ID, EUI\n\n> **Image:** Global settings and LoRaWAN keys, ID, EUI details\n\n13. Now you have a configured OTAA device using WisToolBox Console. You can now join the network using the WisToolBox console.\n\n14. To do this, you need to go again to the WisToolBox console and type **AT+JOIN**. Then edit it to **AT+JOIN=1** then press **Enter** to join the network.\n\n\n> **TIP:** NOTE\n`AT+JOIN` command parameters are optional. You can configure the settings for auto-join, reattempt interval, and the number of join attempts if your application needs it. If not configured, it will use the default parameter values.\n\n`AT+JOIN` and `AT+JOIN=1` also share the common functionality of trying to join the network.\n\n\nJoin command format: **`AT+JOIN=w:x:y:z`**\n\n| Parameter | Description                                                  |\n| :-------: | :----------------------------------------------------------: |\n| w         | Join command - 1: joining, 0: stop joining.                  |\n| x         | Auto-join config - 1: auto-join on power-up, 0: no auto-join |\n| y         | Reattempt interval in seconds (7-255) - 8 is the default.    |\n| z         | Number of join attempts (0-255) - 0 is the default.              |\n\nAfter 5 or 6 seconds, if the request is successfully received by a LoRa gateway, you should see a `+EVT:JOINED` status reply, as shown in the figure below:\n\n\n> **TIP:** NOTE\nIf the OTAA device failed to join, you need to check if your device is within reach of a working LoRaWAN gateway that is configured to connect to TTN. It is also important to check that all your OTAA parameters (DEVEUI, APPEUI, and APPKEY) are correct using the `AT+DEVEUI=?`, `AT+APPEUI=?`, and `AT+APPKEY=?` commands. Lastly, ensure that the antenna of your device is properly connected.\nAfter checking all the things above, try to join again.\n\n\n> **Image:** Joining mode using WisToolBox Console\n\n> **Image:** Joining mode using WisToolBox Console\n\n> **Image:** Joining mode using WisToolBox Console\n\n> **Image:** Joining mode using WisToolBox Console\n\n> **Image:** OTAA device successfully joined the network\n\n> **Image:** OTAA device successfully joined the network\n\n15. With the end-device properly joined to the TTN, try to send some payload after a successful join. Send command format: **`AT+SEND=<port>:<payload>`**\n\n```\nAT+SEND=2:12345678\n```\n\n> **Image:** OTAA device sending payload to the network\n\n> **Image:** OTAA device sending payload to the network\n\n> **Image:** OTAA device sending payload to the network\n\n> **Image:** OTAA device sending payload to the network\n\n16. You can see the data sent by the RAK3172-SiP module on the TTN device console *Live data* section. Also, the *Last seen* info should be a few seconds or minutes ago.\n\n> **Image:** OTAA Test Sample Data Sent Viewed in TTN\n\n##### TTN ABP Device Registration\n\n1. To register an ABP device, go to your application console and select the application to which you want your device to be added. Then click **+ Register end device**, as shown in **Figure 120**.\n\n> **Image:** Adding ABP Device\n\n2. To register the board, click the **Enter end device specifics manually**.\n\n> **Image:** Enter end device specifics manually\n\n3. Next step is to set up **Frequency plan**, compatible **LoRaWAN version**, and **Regional Parameters version** supported.\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n4. Then click **Show advanced activation, LoRaWAN class and cluster settings**. Configure the activation mode by selecting **Activation by personalization (ABP)** and Additional LoRaWAN class capabilities to **class A only**.\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n5. Once done, provide the DevEUI credentials of your device into the **DevEUI** portion. This will automatically generate the specific End\ndevice ID of your board. Then click **Generate** under **Device address**, **AppSKey**, and **NwkSKey** under the Provisioning information section. Then click **Register end device**.\n\n\n> **TIP:** NOTE\nThe **DevEUI**, **Device address**, **AppSKey**, and **NwkSKey** are hidden in this section as these are unique from a specific device. The **DevEUI** credential is unique to every RAK3172-SiP device. Also, you should generate your own **Device address**, **AppSKey**, and **NwkSKey** credentials for your specific device and application.\n\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Setting up for your device\n\n> **Image:** Register end device\n\n6. You should now be able to see the device on the TTN console after you fully register your device, as shown in **Figure 133**.\n\n> **Image:** ABP device successfully registered to TTN\n\n##### ABP Configuration for TTN\n\nThe RAK3172-SiP module can be configured using WisToolBox to do the ABP configuration. **WisToolBox** is a software tool that supports **RAK3172-SiP** module. It automatically detects the RAK3172-SiP module once connected to the PC. Below are the options in WisToolBox that the ABP configuration can be done.\n\n- [ABP Configuration for TTN via WisToolBox UI](#abp-configuration-for-ttn-via-wistoolbox-ui)\n- [ABP Configuration for TTN via WisToolBox Console](#abp-configuration-for-ttn-via-wistoolbox-console)\n\n##### ABP Configuration for TTN via WisToolBox UI\n\nThe **RAK3172-SiP** should have the correct ABP credentials to connect to TTN. This can be done using **WisToolBox**. Below are the steps on setting up your **RAK3172-SiP** using **WisToolBox**.\n\n1. Connect your **RAK3172-SiP** with your chosen WisBlock base board to the PC via USB cable and open the **WisToolBox** application.\n\n2. Click the **CONNECT DEVICE** button to launch the WisToolBox Dashboard.\n\n> **Image:** CONNECT DEVICE\n\n3. Then select your target port where your **RAK3172-SiP** is connected. Once recognized, click **CONNECT** as shown in **Figure 136**.\n\n> **Image:** Setting up your device\n\n> **Image:** Setting up your device\n\n4. Once done, **RAK3172-SiP** will appear in the dashboard then select it.\n\n> **Image:** Device seen from WisToolBox dashboard\n\n5. Then click **PARAMETERS** to do the configuration in your RAK3172-SiP.\n\n\n> **TIP:** NOTE\nThe **AppSKey**, **Device address**, and **NwkSKey** are hidden in this section as these are unique from a specific device.\n\n\n> **Image:** Setting up your device\n\n 6. Click **Global settings** to set the network mode into **LoRaWAN** and join mode to **ABP**. Make sure that the active region is using **EU868** for this configuration. If you wish to work on other regional bands, you can choose among active regions based on your location.\n\n- LoRa network mode: **LoRaWAN**\n- LoRaWAN join mode: **ABP**\n- LoRaWAN region: **EU868**\n\n> **Image:** Global settings\n\n> **Image:** Global settings\n\n7. Then click **LoRaWAN keys, ID, EUI** to configure the **Application session key (AppSKey)**, **Device address** and **Network session key (NwkSKey)**.\n\n> **Image:** LoRaWAN keys, ID, EUI\n\n> **Image:** Setting up your device\n\n8. Then go back to the console where your RAK3172-SiP End device is created previously. Then copy all the credentials from there. Those will be the ones to be used also in the WisToolBox dashboard. Once encoded into the dashboard, click **APPLY COMMANDS** to update your device as shown in **Figure 150**.\n\n\n> **TIP:** NOTE\nThe **AppSKey**, **Device address**, and **NwkSKey** are hidden in this section as these are unique from a specific device.\n\n\n> **Image:** Your created ABP device from your console\n\n- **For Application session key (AppSKey)**\n\n> **Image:** Copying the AppSKey credential from TTN to WisToolBox\n\n> **Image:** Copying the AppSKey credential from TTN to WisToolBox\n\n- **For Device address**\n\n> **Image:** Copying the Device address credential from TTN to WisToolBox\n\n> **Image:** Copying the Device address credential from TTN to WisToolBox\n\n- **For Network session key (NwkSKey)**\n\n> **Image:** Copying the NwkSKey credential from TTN to WisToolBox\n\n> **Image:** Copying the NwkSKey credential from TTN to WisToolBox\n\n- **WisToolBox Dashboard**\n\n> **Image:** Used credentials from your console in WisToolBox dashboard\n\n9. Once done, you will see the summary of commands that is applied to your device. Then click **CLOSE**.\n\n> **Image:** Summary of commands\n\n10. Now you will see it returns to the dashboard with updated credentials of your device.\n\n> **Image:** Successfully configured ABP device via WisToolBox dashboard\n\n##### ABP Configuration for TTN via WisToolBox Console\n\nHere's another way of ABP configuration using **WisToolBox Console**. Below are the steps on setting up your **RAK3172-SiP** using **WisToolBox Console**.\n\n1. Connect your **RAK3172-SiP** with your chosen WisBlock base board to the PC via USB cable and open the **WisToolBox** application.\n\n2. Click the **CONNECT DEVICE** button to launch the WisToolBox Dashboard.\n\n> **Image:** CONNECT DEVICE\n\n3. Then select your target port where your **RAK3172-SiP** is connected. Once recognized, click **CONNECT** as shown in **Figure 155**.\n\n> **Image:** Setting up your device\n\n> **Image:** Setting up your device\n\n4. Once done, **RAK3172-SiP** will appear in the dashboard then select it.\n\n> **Image:** Device seen from WisToolBox dashboard\n\n5. Then click **ADVANCED**.\n\n> **Image:** Setting up your device\n\n6. Once done, click **OPEN CONSOLE** to do the configuration.\n\n> **Image:** OPEN CONSOLE\n\n> **Image:** Opening the Console terminal of WisToolBox\n\n> **Image:** Opening the Console terminal of WisToolBox\n\n7. To start the configuration, type **ATE** so you can echo the commands you input during your configuration. Then press **Enter**.\n\nIt is recommended to start by testing the console and verify that the current configuration is working by sending these two AT commands:\n\n```\nAT\n```\n\n```\nATE\n```\n\n`ATE` is useful for tracking the commands and troubleshooting.\n\nYou will receive `OK` when you input the two commands. After setting `ATE`, see all the commands you input together with the replies.\n\n\n> **TIP:** NOTE\nIf there is no `OK` or any reply, check if the device is powered correctly. If you are getting power from a USB port, ensure that you have a good USB cable.\n\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n8. Then configure the LoRaWAN join mode to **ABP**. You can check what parameter you will input by typing **AT+NJM?** and then **Enter** into the console terminal. For **ABP**, you should input **AT+NJM=0** and then press **Enter** as shown in **Figure 164**.\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n9. Once done, set up your LoRaWAN region to EU868. You can check what parameter you will input by typing **AT+BAND?** and then **Enter** into the console terminal. For **EU868**, you should input **AT+BAND=4** then press **Enter**. If you wish to work on other regional bands, you may check the list of band parameter options below.\n\nSet the frequency/region to EU868.\n\n```\nAT+BAND=4\n```\n\n\n> **TIP:** NOTE\n- Depending on the Regional Band you selected, you might need to configure the sub-band of your RAK3172 to match the gateway and LoRaWAN network server. This is especially important for Regional Bands like US915, AU915, and CN470.\n- To configure the masking of channels for the sub-bands, you can use the `AT+MASK` command that can be found on the [AT Command Manual](https://docs.rakwireless.com/product-categories/wisduo/rak3172-module/at-command-manual/#atmask).\n- To illustrate, you can use sub-band 2 by sending the command `AT+MASK=0002`.\n\n\n**List of band parameter options**\n\n| Code | Regional Band |\n| :--: | :-----------: |\n| 0    | EU433         |\n| 1    | CN470         |\n| 2    | RU864         |\n| 3    | IN865         |\n| 4    | EU868         |\n| 5    | US915         |\n| 6    | AU915         |\n| 7    | KR920         |\n| 8    | AS923-1       |\n| 9    | AS923-2       |\n| 10   | AS923-3       |\n| 11   | AS923-4       |\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n10. Then next to this will be updating the ABP credentials of your device. First to this will be the **Application session key (AppSKey)**. Go back to your console where your RAK3172-SiP End device was created to copy the AppSKey credential then paste it to the WisToolBox Console then press **Enter**.\n\n> **Image:** Your created ABP device from your TTN console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the AppSKey credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n11. Once done, do the same procedure to **Device address** and **Network session key (NwkSKey)**.\n\n- **For Device address**\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the Device address credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n- **For Network session key (NwkSKey)**\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** Copying the NwkSKey credential from TTN to WisToolBox\n\n> **Image:** Setting up your Console\n\n12. Once done, click **Dashboard** to check the updated credentials of your ABP device. Click **PARAMETERS** to open the **Global Settings** and **LoRaWAN keys, ID, EUI** and check whether these portions are updated.\n\n> **Image:** Setting up your Console\n\n> **Image:** Setting up your Console\n\n> **Image:** PARAMETERS\n\n> **Image:** Global settings and LoRaWAN keys, ID, EUI\n\n> **Image:** Global settings and LoRaWAN keys, ID, EUI details\n\n13. Now you have a configured ABP device using WisToolBox Console. **ABP-configured devices** are directly tied to the network once done with the above procedures so the joining procedure is not needed.\n14. Now you can try sending the payload to TTN. Open again the terminal console of WisToolBox to send some payload using it. Send command format: **`AT+SEND=<port>:<payload>`**\n\n```\nAT+SEND=2:12345678\n```\n\n> **Image:** ABP device sending payload to the network\n\n> **Image:** ABP device sending payload to the network\n\n> **Image:** ABP device sending payload to the network\n\n> **Image:** ABP device sending payload to the network\n\n15. You can see the data sent by the RAK3172-SiP module on the TTN device console *Live data* section. Also, the *Last seen* info should be a few seconds or minutes ago.\n\n> **Image:** ABP Test Sample Data Sent Viewed in TTN\n\n##### Connecting with ChirpStack\n\nThis section shows how to connect the RAK3172-SiP to the ChirpStack platform.\n\n> **Image:** RAK3172-SiP in the context of the ChirpStack platform\n\nThe ChirpStack, previously known as the LoRaServer project, provides open-source components for building LoRaWAN networks. Like in the case of TTN, the RAK3172-SiP is located in the periphery and will transmit the data to the backend servers through a LoRaWAN gateway. Learn more about [ChirpStack](https://www.chirpstack.io/).\n\n\n> **TIP:** NOTE\nIt is assumed that you are using a RAK Gateway and its built-in ChirpStack. Also, the gateway with the ChirpStack must be configured successfully. For further information, check the RAK documents for more details.\n\n\n* In summary, these are the requirements:\n\n  1. In a ChirpStack online gateway, the frequency band of the nodes should be consistent with the frequency band of the gateway in use.\n      * [Connect the Gateway with Chirpstack](https://docs.rakwireless.com/product-categories/wisgate/rak7243/quickstart/#connect-the-gateway-with-chirpstack)\n  2. RAK Serial Port Tool provided by RAK\n  3. RAK3172-SiP module\n\n\n> **TIP:** NOTE\nThe frequency band used in the demonstration is EU868.\n\n\n##### Create a New Application\n\n1. Log in to the ChirpStack server using your account and password.\n2. Go to the Application section, as shown in **Figure 197**.\n\n> **Image:** Application section\n\n3. By default, you should create a new application, although you can reuse existing ones. For this setup, create a new Application by clicking on the **CREATE** button and filling in the required parameters, as shown in **Figure 198** and **Figure 199**.\n\n> **Image:** Creating a new application\n\n* For this setup, create an Application named **rak_node_test**.\n\nChirpStack LoraServer supports multiple system configurations, with only one by default.\n\n* **Service profile**: Field is to select the system profile.\n* **Payload codec**: It is the parsing method for selecting load data such as parsing LPP format data.\n\n> **Image:** Filling in the parameters of an application\n\n**Register a New Device**\n\n4. Choose the **Application** created in the previous step, then select the **DEVICES** tab, as shown in **Figure 200** and **Figure 201**.\n\n5. Once done, click â€œ**+ CREATE**â€.\n\n> **Image:** List of applications created\n\n> **Image:** Device tab of an application\n\n6. Once inside the DEVICE tab, create a new device (LoRaWAN node) by clicking on the â€œ**+ CREATE**â€ button.\n\n> **Image:** Add a new device\n\n> **Image:** Chirpstack adding node into the RAK3172-SiP module\n\n7. Once the node is created, fill in the necessary data. You can generate a Device EUI automatically by clicking the following icon, or you can write a correct Device EUI in the edit box.\n\nFill in the parameters requested:\n* **Device name and Device description**: These are descriptive texts about your device.\n* **Device EUI**: This interface allows you to generate a Device EUI automatically by clicking the generate icon. You can also add a specific Device EUI directly in the form.\n* **Device Profile**:\n  * If you want to join in OTAA mode, select **DeviceProfile_OTAA**.\n  * If you want to join in ABP mode, select **DeviceProfile_ABP**.\n\n\n> **TIP:** NOTE\nDevice profiles **DeviceProfile_OTAA** and **DeviceProfile_ABP** are only available if you are using the built-in Chirpstack LoRaWAN Server of RAK Gateways.\n\nIf you have your own Chirpstack installation, you can set up the device profile with `LoRaWAN MAC version 1.0.4` and `LoRaWAN Regional Parameters revision B` to make it compatible with RAK3172-SiP.\n\n\n> **Image:** Generate a new device EUI \n\n##### Chirpstack OTAA Device Registration\n\n1. If you have selected **DeviceProfile_OTAA**, as shown in **Figure 205**, then after the device is created, an Application Key must be also created for this device.\n\n> **Image:** Chirpstack OTAA activation\n\n2. A previously created Application Key can be entered here, or a new one can be generated automatically by clicking the icon highlighted in red in **Figure 206**.\n\n> **Image:** Chirpstack OTAA set application keys\n\n3. Once the Application Key is added to the form, the process can be finalized by clicking on the **SET DEVICE-KEYS** button.\n* As shown in **Figure 207**, a new device should be listed in the **DEVICES** tab. The most important parameters, such as the Device EUI, are shown in the summary.\n\n> **Image:** Chirpstack OTAA list of the device in the device tab\n\n4. To end the process, it is a good practice to review that the Application Key is properly associated with this device. The Application Key can be verified in the **KEYS (OTAA)** tab, as shown in **Figure 208**.\n\n> **Image:** Application key associated with the new device\n\n\n> **TIP:** NOTE\nStandard OTAA mode requires the **Device EUI**, **Application Key**, and **Application EUI**, but in ChirpStackâ€™s implementation, only the Device EUI and the Application Key are mandatory. The Application EUI is not required and not recorded in the Application tab. Nevertheless, you can reuse the Device EUI as the Application EUI during the configuration on the side of the node.\n\n\n##### OTAA Configuration for Chirpstack\n\nThe RAK3172-SiP supports a series of AT commands to configure its internal parameters and control the functionalities of the module.\n\n1. To set up the RAK3172-SiP to join the Chirpstack using OTAA, start by connecting the RAK3172-SiP to the Computer (see **[Figure 26](#connect-to-the-rak3172-sip)**) and open the RAK Serial Port Tool. Select the right COM port and set the baud rate to 115200.\n\nIt is recommended to start by testing the serial communication and verify that the current configuration is working by sending these two AT commands:\n\n```\nAT\n```\n\n```\nATE\n```\n\n`ATE` will echo the commands you input to the module, which is useful for tracking the commands and troubleshooting.\n\nYou will receive `OK` when you input the two commands. After setting `ATE`, see all the commands you input together with the replies. Try again `AT` and you should see it on the terminal followed by `OK`, as shown in **Figure 209**.\n\n\n> **TIP:** NOTE\nIf haven't received an `OK` or any reply, you need to check if the wiring of your UART lines is correct and if the baud is correctly configured to 115200. Also, you can check if the device is powered correctly. If you are getting power from a USB port, ensure that you have a good USB cable.\n\n\n> **Image:** at+version command response\n\n2. The next step is to configure the OTAA LoRaWAN parameters in RAK3172-SiP:\n\n- LoRa work mode: **LoRaWAN**\n- LoRaWAN join mode: **OTAA**\n- LoRaWAN class: **Class A**\n- LoRaWAN region: **EU868**\n\nSet the work mode to LoRaWAN.\n\n```\nAT+NWM=1\n```\n\nSet the LoRaWAN activation to OTAA.\n\n```\nAT+NJM=1\n```\n\nSet the LoRaWAN class to Class A.\n\n```\nAT+CLASS=A\n```\n\nSet the frequency/region to EU868.\n\n```\nAT+BAND=4\n```\n\n\n> **TIP:** NOTE\n- Depending on the regional band you selected, you might need to configure the sub-band of your RAK3172-SiP to match the gateway and LoRaWAN network server. This is especially important for Regional Bands like US915 and AU915.\n- To configure the masking of channels for the sub-bands, you can use the `AT+MASK` command that can be found on the [AT Command Manual](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/at-command-manual/#atmask).\n- To illustrate, you can use sub-band 2 by sending the command `AT+MASK=0002`.\n\n\n**List of band parameter options**\n\n| Code | Regional Band         |\n| :--: | :-------------------: |\n| 0    | EU433 (Not Supported) |\n| 1    | CN470 (Not Supported) |\n| 2    | RU864                 |\n| 3    | IN865                 |\n| 4    | EU868                 |\n| 5    | US915                 |\n| 6    | AU915                 |\n| 7    | KR920                 |\n| 8    | AS923                 |\n\n> **Image:** Configuring LoRa parameters\n\n3. After the configuration of the LoRaWAN parameters, the next step is to set up the DevEUI and AppKey. You need the use the values from the Chirpstack device console.\n\n\n> **TIP:** NOTE\nThe Application EUI parameter is not required in the ChirpStack platform; therefore, it is possible to use the same ID as the Device EUI.\n\n\n- Device EUI: **5E9D1E0857CF25F1**\n- Application EUI: **5E9D1E0857CF25F1**\n- Application Key: **F921D50CD7D02EE3C5E6142154F274B2**\n\nSet the Device EUI.\n\n```\nAT+DEVEUI=5E9D1E0857CF25F1\n```\n\nSet the Application EUI.\n\n```\nAT+APPEUI=5E9D1E0857CF25F1\n```\n\nSet the Application Key.\n\n```\nAT+APPKEY=F921D50CD7D02EE3C5E6142154F274B2\n```\n\n> **Image:** Configuring LoRa Parameters\n\n4. After EUI and key configuration, the device can now join the network and send some payload.\n\n```\nAT+JOIN=1:0:10:8\n```\n\nJoin command format: **`AT+JOIN=w:x:y:z`**\n\n| Parameter | Description                                                  |\n| :-------: | :----------------------------------------------------------: |\n| w         | Join command - 1: joining, 0: stop joining.                  |\n| x         | Auto-join config - 1: auto-join on power-up, 0: no auto-join |\n| y         | Reattempt interval in seconds (7-255) - 8 is the default.    |\n| z         | Number of join attempts (0-255) - 0 is the default.              |\n\nAfter 5 or 6 seconds, if the request is successfully received by a LoRaWAN gateway, you should see the JOINED status reply.\n\n\n> **TIP:** NOTE\nIf the OTAA device failed to join, you need to check if your device is within reach of a working LoRaWAN gateway that is configured to connect to Chirpstack. It is also important to check that all your OTAA parameters (DEVEUI and APPKEY) are correct, using the `AT+DEVEUI=?` and `AT+APPKEY=?` commands. Lastly, ensure that the antenna of your device is properly connected. \n\nAfter checking all the things above, try to join again.\n\n\n5. With the end-device properly activated, try to send some payload after a successful join.\n\n```\nAT+SEND=2:12345678\n```\n\nSend command format: **`AT+SEND=<port>:<payload>`**\n\n> **Image:** OTAA test sample data sent via RAK Serial Port Tool\n\nOn the ChirpStack platform, you should see the join and uplink messages in the **LORAWAN FRAMES** tab, as shown in **Figure 213**. By convention, messages sent from nodes to gateways are considered as **Uplinks** while messages sent by gateways to nodes are considered as **Downlinks**.\n\n> **Image:** Chirpstack data received preview\n\n##### Chirpstack ABP Device Registration\n\n1. During the registration of a new device, if you select **DeviceProfile_ABP**, as shown in **Figure 214**, then the ChirpStack platform will assume that this device will join the LoRaWAN network using the ABP mode.\n\n\n> **TIP:** NOTE\nCheck **Disable counting frame verification**. During the test, when the module is restarted, the frame counting number will also be restarted from zero. This would cause a synchronization problem with the ChirpStack server treating it as a replay attack. For testing purposes, it is safe to disable this feature, but remember to activate it in a production environment.\n\n\n> **Image:** ChirpStack console, Configuring a device\n\n2. After selecting the ABP mode, the following parameters appear in the Activation tab. Then, you can see that there are some parameters for ABP in the **ACTIVATION** item:\n\n  * **Device Address**\n  * **Network Session Key**\n  * **Application Session Key**\n\n> **Image:** Chirpstack ABP activation parameters needed\n\n3. The parameters can be generated as random numbers by the platform or can be set with user values. Once these parameters are filled in properly, the process is completed by clicking on the **ACTIVATE DEVICE** button.\n\n##### ABP Configuration for Chirpstack\n\n1. To set up the RAK3172-SiP to join the Chirpstack using ABP, start by connecting the RAK3172-SiP to the Computer (see **[Figure 26](#connect-to-the-rak3172-sip)**) and open the RAK Serial Port Tool. Select the right COM port and set the baud rate to 115200.\n\nIt is recommended to start by testing the serial communication and verify that the current configuration is working by sending these two AT commands:\n\n```\nAT\n```\n\n```\nATE\n```\n\n`ATE` will echo the commands you input to the module, which is useful for tracking the commands and troubleshooting.\n\nYou will receive `OK` when you input the two commands. After setting `ATE`, see all the commands you input together with the replies. Try again `AT` and you should see it on the terminal followed by `OK`, as shown in **Figure 216**.\n\n\n> **TIP:** NOTE\nIf haven't received an `OK` or any reply, you need to check if the wiring of your UART lines is correct and if the baud is correctly configured to 115200. Also, you can check if the device is powered correctly. If you are getting power from a USB port, ensure that you have a good USB cable.\n\n\n> **Image:** at+version command response\n\n2. The next step is to configure the ABP LoRaWAN parameters in RAK3172-SiP:\n\n- LoRa work mode: **LoRaWAN**\n- LoRaWAN join mode: **ABP**\n- LoRaWAN class: **Class A**\n- LoRaWAN region: **EU868**\n\nSet the work mode to LoRaWAN. It can be set to P2P as well but by default, the device is in LoRaWAN mode.\n\n```\nAT+NWM=1\n```\n\nSet the LoRaWAN activation to ABP.\n\n```\nAT+NJM=0\n```\n\nSet the LoRaWAN class to Class A.\n\n```\nAT+CLASS=A\n```\n\nSet the frequency/region to EU868.\n\n```\nAT+BAND=4\n```\n\n\n> **TIP:** NOTE\n- Depending on the regional band you selected, you might need to configure the sub-band of your RAK3172-SiP to match the gateway and LoRaWAN network server. This is especially important on Regional Bands like US915 and AU915.\n- To configure the masking of channels for the sub-bands, you can use the `AT+MASK command` on the [AT Commands Manual](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/at-command-manual/#atmask).\n- To illustrate, you can use sub-band 2 by sending the command `AT+MASK=0002`.\n\n\n**List of band parameter options**\n\n| Code | Regional Band         |\n| :--: | :-------------------: |\n| 0    | EU433 (Not Supported) |\n| 1    | CN470 (Not Supported) |\n| 2    | RU864                 |\n| 3    | IN865                 |\n| 4    | EU868                 |\n| 5    | US915                 |\n| 6    | AU915                 |\n| 7    | KR920                 |\n| 8    | AS923                 |\n\n> **Image:** Configuring LoRa parameters\n\n3. After the configuration of the LoRaWAN parameters, the next step is to set up the device address and session keys. You need the use the values from the TTN device console.\n\n- Device Address: **26011AF9**\n- Application Session Key: **4D42EC5CAF97F03D833CDAf5003F69E1**\n- Network Session Key: **C280CB8D1DF688BC18601A97025C5488**\n\nSet the Device Address.\n\n```\nAT+DEVADDR=26011AF9\n```\n\nSet the Application Session Key.\n\n```\nAT+APPSKEY=4D42EC5CAF97F03D833CDAf5003F69E1\n```\n\nSet the Network Session Key.\n\n```\nAT+NWKSKEY=C280CB8D1DF688BC18601A97025C5488\n```\n\n> **Image:** Configuring LoRa Parameters\n\nAfter EUI and keys configuration, the device can now join the network and send some payload.\n\n```\nAT+JOIN=1:0:10:8\n```\n\nJoin command format: **`AT+JOIN=w:x:y:z`**\n\n| Parameter | Description                                                  |\n| :-------: | :----------------------------------------------------------: |\n| w         | Join command - 1: joining, 0: stop joining.                  |\n| x         | Auto-join config - 1: auto-join on power-up, 0: no auto-join |\n| y         | Reattempt interval in seconds (7-255) - 8 is the default.    |\n| z         | Number of join attempts (0-255) - 0 is the default.              |\n\n4. After 5 or 6 seconds, if the request is successfully received by a LoRaWAN gateway, then you should see the JOINED status reply.\n\n5. You can now try to send some payload after a successful join.\n\n```\nAT+SEND=2:12341234\n```\nSend command format: **`AT+SEND=<port>:<payload>`**\n\n> **Image:** ABP test sample data sent via RAK Serial Port Tool\n\n#### LoRa P2P Mode\n\nThis section will show you how to set up and connect two RAK3172-SiP units to work in the LoRa P2P mode. The configuration of the RAK3172-SiP units is done by connecting the two modules to a general-purpose computer using a USB-UART converter. The setup of each RAK3172-SiP can be done separately, but testing the LoRa P2P mode will require having both units connected simultaneously. This could be done by having one computer with two USB ports or two computers with one USB port each.\n\nIt is recommended to start by testing the serial communication and verify the current configuration is working by sending these two AT commands:\n\n```\nAT\n```\n\n```\nATE\n```\n\n`ATE` will echo the commands you input to the module, which is useful for tracking the commands and troubleshooting.\n\nYou will receive `OK` when you input the two commands. After setting `ATE`, see all the commands you input together with the replies.\n\nTry again `AT` and you should see it on the terminal followed by `OK`.\n\n> **Image:** at+version command response\n\n1. In setting up the RAK3172 to work in LoRa P2P mode, you need to change the LoRa network work mode command on both RAK3172 modules.\n\n```\nAT+NWM=0\n```\n`AT+NWM` parameter mode can be either 0=LoRa P2P or 1=LoRaWAN.\n\n> **Image:** P2P Mode\n\n\n> **TIP:** NOTE\n- The device will start automatically if you change modes from LoRaWAN to LoRa P2P and vice-versa.\n- You might need to input the `ATE` command again to ensure that your succeeding commands on P2P mode echo on the terminal.\n\n\n2. You need to input the P2P setup on both RAK3172-SiP modules. The parameters should be exactly the same in the two modules.\n\n```\nAT+P2P=868000000:7:125:0:10:14\n```\n\nFor this P2P setup, the LoRa parameters are the following:\n\n- Link frequency: **868000000Â Hz**\n- Spreading factor: **7**\n- Bandwidth: **125Â kHz**\n- Coding Rate: 0 = **4/5**\n- Preamble Length: **10**\n- Power: **14Â dBm**\n\n\n> **TIP:** NOTE\nRefer to the P2P Mode section of the [AT command documentation](https://docs.rakwireless.com/product-categories/wisduo/rak3172-sip/at-command-manual) to learn more about the definition of the parameters used and the individual commands if you want specific parameters changed.\n\n\n> **Image:** Configuring P2P in both RAK3172-SiP Module\n\n3. To set one module as the receiver (RX), you need to set the value of the P2P receive command.\n\n\n> **TIP:** NOTE\nLoRa P2P default setting is Transmitter (TX) mode. This consumes lower power compared to Receiver (RX) mode where the radio is always listening for LoRa packets.\n\n\na. P2P LoRa RX configurable duration value is from 1 to 65533Â ms. In this example, the device will listen and wait for LoRa P2P Packets for 30000Â ms or 30Â seconds. It will automatically disable RX mode and switch to TX mode after the timeout. If the device did not receive any packets within the time period, then the callback after timeout is `+EVT:RXP2P RECEIVE TIMEOUT`.\n\n```\nAT+PRECV=30000\n```\nb. If the `AT+PRECV` value is set to **65535**, the device will listen to P2P LoRa packets without a timeout, but it will stop listening once a P2P LoRa packet is received. After receiving the packets, it will disable RX mode and automatically switch to TX mode again.\n\n```\nAT+PRECV=65535\n```\n\nc. If the `AT+PRECV` value is set to **65534**, the device will continuously listen to P2P LoRa packets without any timeout. It will continuously stay in RX mode until `AT+PRECV` is set to **0**.\n\n```\nAT+PRECV=65534\n```\n\nd. If the `AT+PRECV` value is set to **0**, the device will stop listening to P2P LoRa packets. It disables LoRa P2P RX mode and switches to TX mode.\n\n```\nAT+PRECV=0\n```\n\n4. With one module configured as Transmitter (TX) and the other device will be the Receiver (RX), try to send or transmit P2P payload data.\n\n```\nAT+PSEND= <payload>\n```\n\n> **TIP:** NOTE\n- `AT_PARAM_ERROR` is returned when setting the wrong or malformed value.\n- `AT_BUSY_ERROR` is returned if the device is still in RX mode and you try to send or reconfigure the RX period. If the `AT+PRECV` command is set to **65534**, you need to execute first `AT+PRECV=0` to be able to configure again the TX and RX state and avoid `AT_BUSY_ERROR`.\n- `<payload>`: 2-500 digit length, must be an even number of digits and character 0-9, a-f, A-F only, representing 1~256 hexadecimal numbers. For example, if the payload is like ` 0x03, 0xAA, 0x32`, therefore the AT command should be `AT+PSEND = 03AA32`.\n\n\n> **Image:** Configuring P2P in both RAK3172-SiP Module\n","keywords":[],"source_file":"wisduo\\rak3172-sip\\quickstart.md","token_count":0}
